"use strict";(self.webpackChunkng_alain=self.webpackChunkng_alain||[]).push([[902],{1902:(_t,y,a)=>{a.r(y),a.d(y,{PassportModule:()=>ht});var J=a(4400),h=a(6105),t=a(5e3),g=a(5617),c=a(4521);let Z=(()=>{class n{constructor(e,o,i){this.socialService=e,this.settingsSrv=o,this.route=i,this.type=""}ngOnInit(){this.type=this.route.snapshot.params.type,this.mockModel()}mockModel(){const e={token:"123456789",name:"cipchk",email:`${this.type}@${this.type}.com`,id:1e4,time:+new Date};this.settingsSrv.setUser(Object.assign(Object.assign({},this.settingsSrv.user),e)),this.socialService.callback(e)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(h.VK),t.Y36(g.gb),t.Y36(c.gz))},n.\u0275cmp=t.Xpm({type:n,selectors:[["app-callback"]],features:[t._Bn([h.VK])],decls:0,vars:0,template:function(e,o){},encapsulation:2}),n})();var s=a(2382),Q=a(6699),d=a(4546),f=a(1894),_=a(2683),z=a(1047),C=a(6042),x=a(2643);let T=(()=>{class n{constructor(e,o,i,l){this.tokenService=o,this.settings=i,this.router=l,this.f=e.group({password:[null,s.kI.required]})}get user(){return this.settings.user}submit(){for(const e in this.f.controls)this.f.controls[e].markAsDirty(),this.f.controls[e].updateValueAndValidity();this.f.valid&&(console.log("Valid!"),console.log(this.f.value),this.tokenService.set({token:"123"}),this.router.navigate(["dashboard"]))}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(s.qu),t.Y36(h.T),t.Y36(g.gb),t.Y36(c.F0))},n.\u0275cmp=t.Xpm({type:n,selectors:[["passport-lock"]],decls:15,vars:11,consts:[[1,"ant-card","width-lg",2,"margin","0 auto"],[1,"ant-card-body"],[1,"avatar"],["nzIcon","user","nzSize","large",3,"nzSrc"],["nz-form","","role","form",1,"mt-md",3,"formGroup","ngSubmit"],[3,"nzErrorTip"],["nzSuffixIcon","lock"],["type","password","nz-input","","formControlName","password"],["nzType","flex","nzAlign","middle"],[2,"text-align","right",3,"nzOffset","nzSpan"],["nz-button","","nzType","primary",3,"disabled"]],template:function(e,o){1&e&&(t.TgZ(0,"div",0)(1,"div",1)(2,"div",2),t._UZ(3,"nz-avatar",3),t.qZA(),t.TgZ(4,"form",4),t.NdJ("ngSubmit",function(){return o.submit()}),t.TgZ(5,"nz-form-item")(6,"nz-form-control",5),t.ALo(7,"i18n"),t.TgZ(8,"nz-input-group",6),t._UZ(9,"input",7),t.qZA()()(),t.TgZ(10,"nz-row",8)(11,"nz-col",9)(12,"button",10),t._uU(13),t.ALo(14,"i18n"),t.qZA()()()()()()),2&e&&(t.xp6(3),t.Q6J("nzSrc",o.user.avatar),t.xp6(1),t.Q6J("formGroup",o.f),t.xp6(2),t.Q6J("nzErrorTip",t.lcZ(7,7,"validation.password.required")),t.xp6(5),t.Q6J("nzOffset",12)("nzSpan",12),t.xp6(1),t.Q6J("disabled",!o.f.valid),t.xp6(1),t.Oqu(t.lcZ(14,9,"app.lock")))},directives:[Q.Dz,s._Y,s.JL,d.Lr,s.sg,f.SK,d.Nx,f.t3,d.Fd,_.w,z.gB,z.Zp,s.Fj,s.JJ,s.u,C.ix,x.dQ],pipes:[g.Ck],styles:["[_nghost-%COMP%]     .ant-card-body{position:relative;margin-top:80px}[_nghost-%COMP%]     .avatar{position:absolute;top:-20px;left:50%;margin-left:-20px}"]}),n})();function A(n,r,e,o,i,l,p){try{var m=n[l](p),u=m.value}catch(b){return void e(b)}m.done?r(u):Promise.resolve(u).then(o,i)}function S(n){return function(){var r=this,e=arguments;return new Promise(function(o,i){var l=n.apply(r,e);function p(u){A(l,o,i,p,m,"next",u)}function m(u){A(l,o,i,p,m,"throw",u)}p(void 0)})}}var N=a(5790),I=a(8746),q=a(1936),w=a(9727),v=a(9808),U=a(868),P=a(2359),Y=a(6114);function R(n,r){if(1&n&&t._UZ(0,"nz-alert",16),2&n){const e=t.oxw(2);t.Q6J("nzType","error")("nzMessage",e.error)("nzShowIcon",!0)}}function B(n,r){if(1&n){const e=t.EpF();t.TgZ(0,"form",2),t.NdJ("ngSubmit",function(){return t.CHM(e),t.oxw().submit()}),t.TgZ(1,"nz-tabset",3),t.NdJ("nzSelectChange",function(i){return t.CHM(e),t.oxw().switch(i)}),t.TgZ(2,"nz-tab",4),t.ALo(3,"i18n"),t.YNc(4,R,1,3,"nz-alert",5),t.TgZ(5,"nz-form-item")(6,"nz-form-control",6)(7,"nz-input-group",7),t._UZ(8,"input",8),t.qZA()()(),t.TgZ(9,"nz-form-item")(10,"nz-form-control",9)(11,"nz-input-group",10),t._UZ(12,"input",11),t.qZA()()(),t.TgZ(13,"nz-form-item")(14,"nz-col",12)(15,"label",13),t._uU(16),t.ALo(17,"i18n"),t.qZA()()(),t.TgZ(18,"nz-form-item")(19,"button",14),t._uU(20),t.ALo(21,"i18n"),t.qZA()()(),t.TgZ(22,"nz-tab",4),t.ALo(23,"i18n"),t._UZ(24,"div",15),t.qZA()()()}if(2&n){const e=t.oxw();t.Q6J("formGroup",e.form),t.xp6(1),t.Q6J("nzAnimated",!1),t.xp6(1),t.Q6J("nzTitle",t.lcZ(3,11,"app.login.tab-login-credentials")),t.xp6(2),t.Q6J("ngIf",e.error),t.xp6(10),t.Q6J("nzSpan",12),t.xp6(2),t.Oqu(t.lcZ(17,13,"app.login.remember-me")),t.xp6(3),t.Q6J("nzLoading",e.loading),t.xp6(1),t.hij(" ",t.lcZ(21,15,"app.login.login")," "),t.xp6(2),t.Q6J("nzTitle",t.lcZ(23,17,"app.login.scan")),t.xp6(2),t.Q6J("nzSpan",6)("nzOffset",3)}}function F(n,r){1&n&&(t.TgZ(0,"div",17)(1,"div",18)(2,"div",19)(3,"label"),t._uU(4," \u25cf"),t.qZA(),t.TgZ(5,"label"),t._uU(6," \u25cf"),t.qZA(),t.TgZ(7,"label"),t._uU(8," \u25cf"),t.qZA(),t.TgZ(9,"label"),t._uU(10," \u25cf"),t.qZA(),t.TgZ(11,"label"),t._uU(12," \u25cf"),t.qZA(),t.TgZ(13,"label"),t._uU(14," \u25cf"),t.qZA()()()())}let O=(()=>{class n{constructor(e,o,i,l,p,m,u,b,ft,zt,vt){this.router=o,this.settingsService=i,this.socialService=l,this.activeRoute=p,this.reuseTabService=m,this.tokenService=u,this.startupSrv=b,this.http=ft,this.cdr=zt,this.message=vt,this.oauthLogin=!0,this.error="",this.type=0,this.loading=!1,this.count=0,this.form=e.group({userName:[null,[s.kI.required]],password:[null,[s.kI.required]],mobile:[null,[s.kI.required,s.kI.pattern(/^1\d{10}$/)]],captcha:[null,[s.kI.required]],remember:[!0]})}get userName(){return this.form.get("userName")}get password(){return this.form.get("password")}get mobile(){return this.form.get("mobile")}get captcha(){return this.form.get("captcha")}switch({index:e}){this.type=e,1===this.type&&window.WwLogin({id:"wx_reg",appid:this.corpId,agentid:this.agentId,redirect_uri:window.location.href,state:`${this.randomState()}`})}getCaptcha(){if(this.mobile.invalid)return this.mobile.markAsDirty({onlySelf:!0}),void this.mobile.updateValueAndValidity({onlySelf:!0});this.count=59,this.interval$=setInterval(()=>{this.count-=1,this.count<=0&&clearInterval(this.interval$)},1e3)}submit(){if(this.error="",0===this.type){if(this.userName.markAsDirty(),this.userName.updateValueAndValidity(),this.password.markAsDirty(),this.password.updateValueAndValidity(),this.loginWay="accountPassword",this.userName.invalid||this.password.invalid)return}else if(this.mobile.markAsDirty(),this.mobile.updateValueAndValidity(),this.captcha.markAsDirty(),this.captcha.updateValueAndValidity(),this.mobile.invalid||this.captcha.invalid)return;this.appId||this.message.error("\u65e0\u6548\u94fe\u63a5"),this.loading=!0,this.cdr.detectChanges(),this.loginHttp()}ngOnDestroy(){this.interval$&&clearInterval(this.interval$)}ngOnInit(){var e=this;return S(function*(){e.activeRoute.queryParams.subscribe(i=>{const l=i.code,p=i.appId;void 0!==l&&""!==l&&void 0!==p&&""!==p&&(e.oauthLogin=!1,console.log(e.oauthLogin))}),yield e.judgeScanQrCodeLogin();const o=yield e.obtainUrlId();yield e.obtainCorpId(o)})()}judgeScanQrCodeLogin(){this.activeRoute.queryParams.subscribe(e=>{console.log(e);const o=e.code,i=e.appId;void 0!==o&&""!==o&&void 0!==i&&""!==i&&this.scanQrCodeTechnologicalProcess(o,i)})}obtainUrlId(){return new Promise((e,o)=>{location.href.includes("appId=")?(this.appId=location.href.split("appId=")[1].split("&")[0],localStorage.setItem("appId",this.appId)):this.appId=localStorage.getItem("appId"),e(this.appId)})}obtainCorpId(e){!this.appId||this.http.get("service/portal/appId/"+e+"?_allow_anonymous=true").subscribe(o=>{this.corpId=o.data.corpId,this.agentId=o.data.agentId})}randomState(){let e="";const o="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";for(let i=0;i<5;i++)e+=o.charAt(Math.floor(Math.random()*o.length));return e}scanQrCodeTechnologicalProcess(e,o){var i=this;return S(function*(){i.loginWay="scanCode",yield i.loginHttp(e,o)})()}loginHttp(e,o){const i=this.postDataGet(e,o);this.http.post("/service/portal/login?_allow_anonymous=true",i).pipe((0,I.x)(()=>{this.loading=!0,this.cdr.detectChanges()})).subscribe(l=>{if(200!==l.code)return this.error=l.msg,void this.cdr.detectChanges();this.reuseTabService.clear(),this.tokenService.set(l.data),this.startupSrv.load().subscribe(()=>{let p=this.tokenService.referrer.url||"/";p.includes("/passport")&&(p="/"),this.router.navigateByUrl(p)})})}postDataGet(e,o){const i={type:this.type,account:this.userName.value,password:this.password.value,appId:this.appId,loginWay:this.loginWay};return e&&o&&(i.authCode=e,i.appId=o,delete i.password,delete i.account,delete i.type),i}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(s.qu),t.Y36(c.F0),t.Y36(g.gb),t.Y36(h.VK),t.Y36(c.gz),t.Y36(N.Wu,8),t.Y36(h.T),t.Y36(q.HS),t.Y36(g.lP),t.Y36(t.sBO),t.Y36(w.dD))},n.\u0275cmp=t.Xpm({type:n,selectors:[["passport-login"]],features:[t._Bn([h.VK])],decls:2,vars:2,consts:[["nz-form","","role","form",3,"formGroup","ngSubmit",4,"ngIf"],["class","preloader",4,"ngIf"],["nz-form","","role","form",3,"formGroup","ngSubmit"],[1,"tabs",3,"nzAnimated","nzSelectChange"],[3,"nzTitle"],["class","mb-lg",3,"nzType","nzMessage","nzShowIcon",4,"ngIf"],["nzErrorTip","\u8bf7\u8f93\u5165\u6b63\u786e\u8d26\u53f7"],["nzSize","large","nzPrefixIcon","user"],["nz-input","","formControlName","userName","placeholder","\u8bf7\u8f93\u5165\u8d26\u53f7"],["nzErrorTip","\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u5bc6\u7801"],["nzSize","large","nzPrefixIcon","lock"],["nz-input","","type","password","formControlName","password","placeholder","\u8bf7\u8f93\u5165\u5bc6\u7801"],[3,"nzSpan"],["nz-checkbox","","formControlName","remember"],["nz-button","","type","submit","nzType","primary","nzSize","large","nzBlock","",3,"nzLoading"],["nz-col","","id","wx_reg",3,"nzSpan","nzOffset"],[1,"mb-lg",3,"nzType","nzMessage","nzShowIcon"],[1,"preloader"],[1,"cs-loader"],[1,"cs-loader-inner"]],template:function(e,o){1&e&&(t.YNc(0,B,25,19,"form",0),t.YNc(1,F,15,0,"div",1)),2&e&&(t.Q6J("ngIf",o.oauthLogin),t.xp6(1),t.Q6J("ngIf",!o.oauthLogin))},directives:[v.O5,s._Y,s.JL,d.Lr,s.sg,U.xH,U.xw,P.r,f.SK,d.Nx,f.t3,d.Fd,_.w,z.gB,z.Zp,s.Fj,s.JJ,s.u,Y.Ie,C.ix,x.dQ],pipes:[g.Ck],styles:["[_nghost-%COMP%]{display:block;width:368px;margin:0 auto}[_nghost-%COMP%]     .ant-tabs .ant-tabs-bar{margin-bottom:24px;text-align:center;border-bottom:0}[_nghost-%COMP%]     .ant-tabs-tab{font-size:16px;line-height:24px}[_nghost-%COMP%]     .ant-input-affix-wrapper .ant-input:not(:first-child){padding-left:4px}[_nghost-%COMP%]     .icon{margin-left:16px;color:#0003;font-size:24px;vertical-align:middle;cursor:pointer;transition:color .3s}[_nghost-%COMP%]     .icon:hover{color:#1890ff}[_nghost-%COMP%]     .other{margin-top:24px;line-height:22px;text-align:left}[_nghost-%COMP%]     .other nz-tooltip{vertical-align:middle}[_nghost-%COMP%]     .other .register{float:right}[data-theme=dark]   [_nghost-%COMP%]     .icon{color:#fff3}[data-theme=dark]   [_nghost-%COMP%]     .icon:hover{color:#fff}",".preloader[_ngcontent-%COMP%]{position:fixed;top:0;left:0;z-index:9999;width:100%;height:100%;overflow:hidden;background:#49a9ee;transition:opacity .65s}.preloader-hidden-add[_ngcontent-%COMP%]{display:block;opacity:1}.preloader-hidden-add-active[_ngcontent-%COMP%]{opacity:0}.preloader-hidden[_ngcontent-%COMP%]{display:none}.cs-loader[_ngcontent-%COMP%]{position:absolute;top:0;left:0;width:100%;height:100%}.cs-loader-inner[_ngcontent-%COMP%]{position:absolute;top:50%;width:100%;color:#fff;text-align:center;transform:translateY(-50%)}.cs-loader-inner[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{display:inline-block;font-size:20px;opacity:0}@keyframes lol{0%{transform:translateX(-300px);opacity:0}33%{transform:translateX(0);opacity:1}66%{transform:translateX(0);opacity:1}100%{transform:translateX(300px);opacity:0}}.cs-loader-inner[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-child(6){animation:lol 3s infinite ease-in-out}.cs-loader-inner[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-child(5){animation:lol 3s .1s infinite ease-in-out}.cs-loader-inner[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-child(4){animation:lol 3s .2s infinite ease-in-out}.cs-loader-inner[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-child(3){animation:lol 3s .3s infinite ease-in-out}.cs-loader-inner[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-child(2){animation:lol 3s .4s infinite ease-in-out}.cs-loader-inner[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]:nth-child(1){animation:lol 3s .5s infinite ease-in-out}"],changeDetection:0}),n})();var V=a(4399),D=a(9486);function E(n,r){if(1&n&&(t.TgZ(0,"div",4),t._uU(1),t.ALo(2,"i18n"),t.qZA()),2&n){const e=t.oxw();t.xp6(1),t.hij(" ",t.xi3(2,1,"app.register-result.msg",e.params)," ")}}let k=(()=>{class n{constructor(e,o){this.msg=o,this.params={email:""},this.email="",this.params.email=this.email=e.snapshot.queryParams.email||"ng-alain@example.com"}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(c.gz),t.Y36(w.dD))},n.\u0275cmp=t.Xpm({type:n,selectors:[["passport-register-result"]],decls:10,vars:11,consts:[["type","success",3,"title","description"],["title",""],["nz-button","","nzSize","large",3,"nzType","click"],["routerLink","/","nz-button","","nzSize","large"],[1,"title",2,"font-size","20px"]],template:function(e,o){if(1&e&&(t.TgZ(0,"result",0),t.ALo(1,"i18n"),t.YNc(2,E,3,4,"ng-template",null,1,t.W1O),t.TgZ(4,"button",2),t.NdJ("click",function(){return o.msg.success("email")}),t._uU(5),t.ALo(6,"i18n"),t.qZA(),t.TgZ(7,"button",3),t._uU(8),t.ALo(9,"i18n"),t.qZA()()),2&e){const i=t.MAs(3);t.s9C("description",t.lcZ(1,5,"app.register-result.activation-email")),t.Q6J("title",i),t.xp6(4),t.Q6J("nzType","primary"),t.xp6(1),t.hij(" ",t.lcZ(6,7,"app.register-result.view-mailbox")," "),t.xp6(3),t.hij(" ",t.lcZ(9,9,"app.register-result.back-home")," ")}},directives:[D.N,C.ix,x.dQ,_.w,c.rH],pipes:[g.Ck],encapsulation:2}),n})();function j(n,r){return e=>{const o=e.get(n),i=e.get(r);return i.errors&&!i.errors.matchControl||i.setErrors(o.value!==i.value?{matchControl:!0}:null),null}}var W=a(3610),$=a(4342),M=a(8054);function G(n,r){if(1&n&&t._UZ(0,"nz-alert",23),2&n){const e=t.oxw();t.Q6J("nzType","error")("nzMessage",e.error)("nzShowIcon",!0)}}function X(n,r){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.email.required")))}function H(n,r){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.email.wrong-format")))}function K(n,r){if(1&n&&(t.YNc(0,X,3,3,"ng-container",24),t.YNc(1,H,3,3,"ng-container",24)),2&n){const e=r.$implicit;t.Q6J("ngIf",null==e.errors?null:e.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.email)}}function tt(n,r){1&n&&(t.TgZ(0,"div",32),t._uU(1),t.ALo(2,"i18n"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.password.strength.strong")))}function et(n,r){1&n&&(t.TgZ(0,"div",33),t._uU(1),t.ALo(2,"i18n"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.password.strength.medium")))}function nt(n,r){1&n&&(t.TgZ(0,"div",34),t._uU(1),t.ALo(2,"i18n"),t.qZA()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.password.strength.short")))}function ot(n,r){if(1&n&&(t.TgZ(0,"div",25),t.ynx(1,26),t.YNc(2,tt,3,3,"div",27),t.YNc(3,et,3,3,"div",28),t.YNc(4,nt,3,3,"div",29),t.BQk(),t.TgZ(5,"div"),t._UZ(6,"nz-progress",30),t.qZA(),t.TgZ(7,"p",31),t._uU(8),t.ALo(9,"i18n"),t.qZA()()),2&n){const e=t.oxw();t.xp6(1),t.Q6J("ngSwitch",e.status),t.xp6(1),t.Q6J("ngSwitchCase","ok"),t.xp6(1),t.Q6J("ngSwitchCase","pass"),t.xp6(2),t.Gre("progress-",e.status,""),t.xp6(1),t.Q6J("nzPercent",e.progress)("nzStatus",e.passwordProgressMap[e.status])("nzStrokeWidth",6)("nzShowInfo",!1),t.xp6(2),t.Oqu(t.lcZ(9,11,"validation.password.strength.msg"))}}function rt(n,r){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.confirm-password.required")))}function it(n,r){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.password.twice")))}function st(n,r){if(1&n&&(t.YNc(0,rt,3,3,"ng-container",24),t.YNc(1,it,3,3,"ng-container",24)),2&n){const e=r.$implicit;t.Q6J("ngIf",null==e.errors?null:e.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.matchControl)}}function at(n,r){1&n&&(t.TgZ(0,"nz-select",35),t._UZ(1,"nz-option",36)(2,"nz-option",36),t.qZA()),2&n&&(t.xp6(1),t.Q6J("nzLabel","+86")("nzValue","+86"),t.xp6(1),t.Q6J("nzLabel","+87")("nzValue","+87"))}function lt(n,r){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.phone-number.required")))}function pt(n,r){1&n&&(t.ynx(0),t._uU(1),t.ALo(2,"i18n"),t.BQk()),2&n&&(t.xp6(1),t.Oqu(t.lcZ(2,1,"validation.phone-number.wrong-format")))}function ct(n,r){if(1&n&&(t.YNc(0,lt,3,3,"ng-container",24),t.YNc(1,pt,3,3,"ng-container",24)),2&n){const e=r.$implicit;t.Q6J("ngIf",null==e.errors?null:e.errors.required),t.xp6(1),t.Q6J("ngIf",null==e.errors?null:e.errors.pattern)}}const ut=function(){return{"width.px":240}};const gt=[{path:"passport",component:V.W,children:[{path:"login",component:O,data:{title:"\u767b\u5f55",titleI18n:"app.login.login"}},{path:"register",component:(()=>{class n{constructor(e,o,i,l){this.router=o,this.http=i,this.cdr=l,this.error="",this.type=0,this.loading=!1,this.visible=!1,this.status="pool",this.progress=0,this.passwordProgressMap={ok:"success",pass:"normal",pool:"exception"},this.count=0,this.form=e.group({mail:[null,[s.kI.required,s.kI.email]],password:[null,[s.kI.required,s.kI.minLength(6),n.checkPassword.bind(this)]],confirm:[null,[s.kI.required,s.kI.minLength(6)]],mobilePrefix:["+86"],mobile:[null,[s.kI.required,s.kI.pattern(/^1\d{10}$/)]],captcha:[null,[s.kI.required]]},{validators:j("password","confirm")})}get mail(){return this.form.get("mail")}get password(){return this.form.get("password")}get confirm(){return this.form.get("confirm")}get mobile(){return this.form.get("mobile")}get captcha(){return this.form.get("captcha")}static checkPassword(e){if(!e)return null;const o=this;o.visible=!!e.value,o.status=e.value&&e.value.length>9?"ok":e.value&&e.value.length>5?"pass":"pool",o.visible&&(o.progress=10*e.value.length>100?100:10*e.value.length)}getCaptcha(){if(this.mobile.invalid)return this.mobile.markAsDirty({onlySelf:!0}),void this.mobile.updateValueAndValidity({onlySelf:!0});this.count=59,this.cdr.detectChanges(),this.interval$=setInterval(()=>{this.count-=1,this.cdr.detectChanges(),this.count<=0&&clearInterval(this.interval$)},1e3)}submit(){if(this.error="",Object.keys(this.form.controls).forEach(o=>{this.form.controls[o].markAsDirty(),this.form.controls[o].updateValueAndValidity()}),this.form.invalid)return;const e=this.form.value;this.loading=!0,this.cdr.detectChanges(),this.http.post("/register?_allow_anonymous=true",e).pipe((0,I.x)(()=>{this.loading=!1,this.cdr.detectChanges()})).subscribe(()=>{this.router.navigate(["passport","register-result"],{queryParams:{email:e.mail}})})}ngOnDestroy(){this.interval$&&clearInterval(this.interval$)}}return n.\u0275fac=function(e){return new(e||n)(t.Y36(s.qu),t.Y36(c.F0),t.Y36(g.lP),t.Y36(t.sBO))},n.\u0275cmp=t.Xpm({type:n,selectors:[["passport-register"]],decls:50,vars:34,consts:[["nz-form","","role","form",3,"formGroup","ngSubmit"],["class","mb-lg",3,"nzType","nzMessage","nzShowIcon",4,"ngIf"],[3,"nzErrorTip"],["nzSize","large","nzAddonBeforeIcon","user"],["nz-input","","formControlName","mail","placeholder","Email"],["mailErrorTip",""],["nzSize","large","nzAddonBeforeIcon","lock","nz-popover","","nzPopoverPlacement","right","nzPopoverTrigger","focus","nzPopoverOverlayClassName","register-password-cdk",3,"nzPopoverVisible","nzPopoverOverlayStyle","nzPopoverContent","nzPopoverVisibleChange"],["nz-input","","type","password","formControlName","password","placeholder","Password"],["pwdCdkTpl",""],["nzSize","large","nzAddonBeforeIcon","lock"],["nz-input","","type","password","formControlName","confirm","placeholder","Confirm Password"],["confirmErrorTip",""],["nzSize","large",3,"nzAddOnBefore"],["addOnBeforeTemplate",""],["formControlName","mobile","nz-input","","placeholder","Phone number"],["mobileErrorTip",""],[3,"nzGutter"],[3,"nzSpan"],["nzSize","large","nzAddonBeforeIcon","mail"],["nz-input","","formControlName","captcha","placeholder","Captcha"],["type","button","nz-button","","nzSize","large","nzBlock","",3,"disabled","nzLoading","click"],["nz-button","","nzType","primary","nzSize","large","type","submit",1,"submit",3,"nzLoading"],["routerLink","/passport/login",1,"login"],[1,"mb-lg",3,"nzType","nzMessage","nzShowIcon"],[4,"ngIf"],[2,"padding","4px 0"],[3,"ngSwitch"],["class","success",4,"ngSwitchCase"],["class","warning",4,"ngSwitchCase"],["class","error",4,"ngSwitchDefault"],[3,"nzPercent","nzStatus","nzStrokeWidth","nzShowInfo"],[1,"mt-sm"],[1,"success"],[1,"warning"],[1,"error"],["formControlName","mobilePrefix",2,"width","100px"],[3,"nzLabel","nzValue"]],template:function(e,o){if(1&e&&(t.TgZ(0,"h3"),t._uU(1),t.ALo(2,"i18n"),t.qZA(),t.TgZ(3,"form",0),t.NdJ("ngSubmit",function(){return o.submit()}),t.YNc(4,G,1,3,"nz-alert",1),t.TgZ(5,"nz-form-item")(6,"nz-form-control",2)(7,"nz-input-group",3),t._UZ(8,"input",4),t.qZA(),t.YNc(9,K,2,2,"ng-template",null,5,t.W1O),t.qZA()(),t.TgZ(11,"nz-form-item")(12,"nz-form-control",2),t.ALo(13,"i18n"),t.TgZ(14,"nz-input-group",6),t.NdJ("nzPopoverVisibleChange",function(l){return o.visible=l}),t._UZ(15,"input",7),t.qZA(),t.YNc(16,ot,10,13,"ng-template",null,8,t.W1O),t.qZA()(),t.TgZ(18,"nz-form-item")(19,"nz-form-control",2)(20,"nz-input-group",9),t._UZ(21,"input",10),t.qZA(),t.YNc(22,st,2,2,"ng-template",null,11,t.W1O),t.qZA()(),t.TgZ(24,"nz-form-item")(25,"nz-form-control",2)(26,"nz-input-group",12),t.YNc(27,at,3,4,"ng-template",null,13,t.W1O),t._UZ(29,"input",14),t.qZA(),t.YNc(30,ct,2,2,"ng-template",null,15,t.W1O),t.qZA()(),t.TgZ(32,"nz-form-item")(33,"nz-form-control",2),t.ALo(34,"i18n"),t.TgZ(35,"nz-row",16)(36,"nz-col",17)(37,"nz-input-group",18),t._UZ(38,"input",19),t.qZA()(),t.TgZ(39,"nz-col",17)(40,"button",20),t.NdJ("click",function(){return o.getCaptcha()}),t._uU(41),t.ALo(42,"i18n"),t.qZA()()()()(),t.TgZ(43,"nz-form-item")(44,"button",21),t._uU(45),t.ALo(46,"i18n"),t.qZA(),t.TgZ(47,"a",22),t._uU(48),t.ALo(49,"i18n"),t.qZA()()()),2&e){const i=t.MAs(10),l=t.MAs(17),p=t.MAs(23),m=t.MAs(28),u=t.MAs(31);t.xp6(1),t.Oqu(t.lcZ(2,21,"app.register.register")),t.xp6(2),t.Q6J("formGroup",o.form),t.xp6(1),t.Q6J("ngIf",o.error),t.xp6(2),t.Q6J("nzErrorTip",i),t.xp6(6),t.Q6J("nzErrorTip",t.lcZ(13,23,"validation.password.required")),t.xp6(2),t.Q6J("nzPopoverVisible",o.visible)("nzPopoverOverlayStyle",t.DdM(33,ut))("nzPopoverContent",l),t.xp6(5),t.Q6J("nzErrorTip",p),t.xp6(6),t.Q6J("nzErrorTip",u),t.xp6(1),t.Q6J("nzAddOnBefore",m),t.xp6(7),t.Q6J("nzErrorTip",t.lcZ(34,25,"validation.verification-code.required")),t.xp6(2),t.Q6J("nzGutter",8),t.xp6(1),t.Q6J("nzSpan",16),t.xp6(3),t.Q6J("nzSpan",8),t.xp6(1),t.Q6J("disabled",o.count>0)("nzLoading",o.loading),t.xp6(1),t.hij(" ",o.count?o.count+"s":t.lcZ(42,27,"app.register.get-verification-code")," "),t.xp6(3),t.Q6J("nzLoading",o.loading),t.xp6(1),t.hij(" ",t.lcZ(46,29,"app.register.register")," "),t.xp6(3),t.Oqu(t.lcZ(49,31,"app.register.sign-in"))}},directives:[s._Y,s.JL,d.Lr,s.sg,v.O5,P.r,f.SK,d.Nx,f.t3,d.Fd,_.w,z.gB,z.Zp,s.Fj,s.JJ,s.u,W.lU,v.RF,v.n9,v.ED,$.M,M.Vq,M.Ip,C.ix,x.dQ,c.yS],pipes:[g.Ck],styles:["[_nghost-%COMP%]{display:block;width:368px;margin:0 auto}[_nghost-%COMP%]     h3{margin-bottom:20px;font-size:16px}[_nghost-%COMP%]     .submit{width:50%}[_nghost-%COMP%]     .login{float:right;line-height:40px}  .register-password-cdk .success,   .register-password-cdk .warning,   .register-password-cdk .error{transition:color .3s}  .register-password-cdk .success{color:#52c41a}  .register-password-cdk .warning{color:#faad14}  .register-password-cdk .error{color:#ff4d4f}  .register-password-cdk .progress-pass>.progress .ant-progress-bg{background-color:#faad14}"],changeDetection:0}),n})(),data:{title:"\u6ce8\u518c",titleI18n:"app.register.register"}},{path:"register-result",component:k,data:{title:"\u6ce8\u518c\u7ed3\u679c",titleI18n:"app.register.register"}},{path:"lock",component:T,data:{title:"\u9501\u5c4f",titleI18n:"app.lock"}}]},{path:"passport/callback/:type",component:Z}];let dt=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({imports:[[c.Bz.forChild(gt)],c.Bz]}),n})();var mt=a(520);let ht=(()=>{class n{}return n.\u0275fac=function(e){return new(e||n)},n.\u0275mod=t.oAB({type:n}),n.\u0275inj=t.cJS({providers:[{provide:mt.TP,useClass:h.sT,multi:!0}],imports:[[J.m8,dt]]}),n})()}}]);
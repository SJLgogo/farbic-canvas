"use strict";(self.webpackChunkng_alain=self.webpackChunkng_alain||[]).push([[435],{8435:(fo,xe,l)=>{l.r(xe),l.d(xe,{SetupModule:()=>go});var Te=l(4400),e=l(5e3),u=l(5617),Z=l(4521),f=l(7957),h=l(9727),p=l(9808),y=l(9590),v=l(3186),g=l(6042),_=l(2643),m=l(2683);function $e(i,s){1&i&&e._UZ(0,"nz-spin",4)}function Ge(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e._uU(4,"\u5173\u95ed"),e.qZA(),e.TgZ(5,"button",9),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().save(o.value)}),e._uU(6," \u4fdd\u5b58 "),e.qZA()()()}if(2&i){const t=e.MAs(1),n=e.oxw();e.Q6J("schema",n.schema)("ui",n.ui)("formData",n.i),e.xp6(5),e.Q6J("disabled",!t.valid)("nzLoading",n.http.loading)}}let K=(()=>{class i{constructor(t,n,o){this.modal=t,this.msgSrv=n,this.http=o,this.record={},this.schema={properties:{name:{type:"string",title:"\u540d\u79f0"},code:{type:"string",title:"\u7f16\u53f7"},level:{type:"number",title:"\u6392\u5e8f"},remark:{type:"string",title:"\u63cf\u8ff0",maxLength:140}},required:["name"]},this.ui={"*":{spanLabelFixed:100},$remark:{widget:"textarea"}}}ngOnInit(){console.log(this.parentJob),console.log(this.record),this.record.id>0?this.http.get(`/service/contact/admin/job/${this.record.id}`).subscribe(t=>{this.i=t.data}):this.i={}}save(t){t.parentId=this.parentJob.id,this.http.post("/service/contact/admin/job/save",t).subscribe(n=>{this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(!0)})}close(){this.modal.destroy()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.Lf),e.Y36(h.dD),e.Y36(u.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-system-contact-job-edit"]],decls:5,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA()(),e.YNc(3,$e,1,0,"nz-spin",2),e.YNc(4,Ge,7,5,"sf",3)),2&t&&(e.xp6(2),e.hij("\u7f16\u8f91 ",n.record.id," \u4fe1\u606f"),e.xp6(1),e.Q6J("ngIf",!n.i),e.xp6(1),e.Q6J("ngIf",n.i))},directives:[p.O5,y.W,v.kJ,g.ix,_.dQ,m.w],encapsulation:2}),i})();function We(i,s){1&i&&e._UZ(0,"nz-spin",4)}function Xe(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e._uU(4,"\u5173\u95ed"),e.qZA(),e.TgZ(5,"button",9),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().save(o.value)}),e._uU(6," \u4fdd\u5b58 "),e.qZA()()()}if(2&i){const t=e.MAs(1),n=e.oxw();e.Q6J("schema",n.schema)("ui",n.ui)("formData",n.postData),e.xp6(5),e.Q6J("disabled",!t.valid)("nzLoading",n.http.loading)}}let ee=(()=>{class i{constructor(t,n,o){this.modal=t,this.msgSrv=n,this.http=o,this.record={},this.organization={},this.postData={},this.schema={properties:{name:{type:"string",title:"\u5c97\u4f4d\u540d\u79f0"},organizationName:{type:"string",title:"\u6240\u5c5e\u90e8\u95e8",readOnly:!0},level:{type:"number",title:"\u5c42\u7ea7\u7f16\u53f7"},organizationPrincipal:{type:"boolean",title:"\u662f\u5426\u8d23\u4efb\u5c97\u4f4d",ui:{checkedChildren:"\u5f00",unCheckedChildren:"\u5173"}},remark:{type:"string",title:"\u63cf\u8ff0",maxLength:100}},required:["name"]},this.ui={"*":{spanLabelFixed:100,grid:{span:12}},$name:{widget:"string"},$remark:{widget:"textarea",grid:{span:24}}}}ngOnInit(){console.log(this.record),console.log(this.organization),null!=this.record&&this.http.get("/service/contact/admin/post/"+this.record.id).subscribe(t=>{t.success&&(this.postData=t.data)})}save(t){null==t.id&&(t.organizationId=this.organization.id),this.http.post("/service/contact/admin/post/save",t).subscribe(n=>{this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(!0)})}close(){this.modal.destroy()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.Lf),e.Y36(h.dD),e.Y36(u.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-system-contact-post-edit"]],decls:5,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","layout","vertical","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","layout","vertical","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA()(),e.YNc(3,We,1,0,"nz-spin",2),e.YNc(4,Xe,7,5,"sf",3)),2&t&&(e.xp6(2),e.hij("\u7f16\u8f91 ",n.postData.name," \u4fe1\u606f"),e.xp6(1),e.Q6J("ngIf",!n.postData),e.xp6(1),e.Q6J("ngIf",n.postData))},directives:[p.O5,y.W,v.kJ,g.ix,_.dQ,m.w],encapsulation:2}),i})();var D=l(5017),k=l(7664);const Ke=["st"];let ze=(()=>{class i{constructor(t,n,o,r){this.modal=t,this.modalHelper=n,this.msgSrv=o,this.http=r,this.organization={},this.postList=[],this.url="/service/contact/admin/post/organization/table",this.postTableRequest={allInBody:!0,method:"POST",reName:{pi:"page",ps:"pageSize"},params:{orgId:null,isRecursive:!1}},this.columns=[{title:"\u7f16\u53f7",index:"id",type:"radio"},{title:"\u5c97\u4f4d\u540d\u79f0",index:"name"},{title:"\u8d23\u4efb\u5c97\u4f4d",index:"organizationPrincipal",type:"badge"},{title:"\u6392\u5e8f",index:"level"},{title:"\u5c97\u4f4d\u63cf\u8ff0",index:"remark"},{title:"\u64cd\u4f5c",buttons:[{text:"\u7f16\u8f91",type:"static",icon:"edit",click:c=>this.edit(c)},{text:"\u5220\u9664",icon:"delete",type:"del",click:c=>this.remove(c)}]}]}change(t){console.log("change",t)}dataChange(t){return t.map((n,o)=>(n.disabled=0===o,n.hidden=1===o,n))}ngOnInit(){this.findPostByOrg(this.organization.id)}findPostByOrg(t){this.http.post("/service/contact/admin/post/organization",{orgId:t,isRecursive:!1}).subscribe(o=>{o.success&&(this.postList=o.data)})}addPost(t){this.modalHelper.createStatic(ee,{record:t,organization:this.organization}).subscribe(()=>this.findPostByOrg(this.organization.id))}edit(t){this.modalHelper.createStatic(ee,{record:t}).subscribe(()=>this.findPostByOrg(this.organization.id))}remove(t){this.http.post("/service/contact/admin/post/remove",t).subscribe(n=>{n.success?(this.msgSrv.success(n.message),this.findPostByOrg(this.organization.id)):this.msgSrv.error(n.message)})}save(){}close(){this.modal.destroy()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.Lf),e.Y36(u.Te),e.Y36(h.dD),e.Y36(u.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-system-contact-post-setup"]],viewQuery:function(t,n){if(1&t&&e.Gf(Ke,5),2&t){let o;e.iGM(o=e.CRH())&&(n.st=o.first)}},decls:14,vars:4,consts:[[1,"modal-header"],[1,"modal-title"],[2,"margin-bottom","8px"],["nzType","primary","nz-button","",3,"click"],["nz-icon","","nzType","plus"],[3,"data","columns"],["st",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA()(),e.TgZ(3,"div",2)(4,"button",3),e.NdJ("click",function(){return n.addPost({})}),e._UZ(5,"i",4),e._uU(6,"\u65b0\u589e\u5c97\u4f4d"),e.qZA()(),e._UZ(7,"st",5,6),e.TgZ(9,"div",7)(10,"button",8),e.NdJ("click",function(){return n.close()}),e._uU(11,"\u5173\u95ed"),e.qZA(),e.TgZ(12,"button",9),e.NdJ("click",function(){return n.save()}),e._uU(13,"\u4fdd\u5b58"),e.qZA()()),2&t&&(e.xp6(2),e.hij("[",n.organization.name,"]\u5c97\u4f4d\u8bbe\u7f6e"),e.xp6(5),e.Q6J("data",n.postList)("columns",n.columns),e.xp6(5),e.Q6J("nzLoading",n.http.loading))},directives:[g.ix,_.dQ,m.w,D.Ls,k.A5],encapsulation:2}),i})();var te=l(4004);function et(i,s){if(1&i&&(e.TgZ(0,"div",4),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij("\u6dfb\u52a0[",t.menu.title,"]\u7684\u4e0b\u7ea7\u83dc\u5355")}}function tt(i,s){if(1&i&&(e.TgZ(0,"div",4),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij("\u7f16\u8f91 [",t.menu.title,"] \u4fe1\u606f")}}function nt(i,s){1&i&&e._UZ(0,"nz-spin",5)}function it(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"sf",6,7)(2,"div",8)(3,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e._uU(4,"\u5173\u95ed"),e.qZA(),e.TgZ(5,"button",10),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().save(o.value)}),e._uU(6," \u4fdd\u5b58 "),e.qZA()()()}if(2&i){const t=e.MAs(1),n=e.oxw();e.Q6J("schema",n.schema)("ui",n.ui)("formData",n.menu),e.xp6(5),e.Q6J("disabled",!t.valid)("nzLoading",n.http.loading)}}let ne=(()=>{class i{constructor(t,n,o){this.modal=t,this.msgSrv=n,this.http=o,this.record={},this.schema={properties:{applicationId:{type:"string",title:"\u5173\u8054\u7684\u516c\u53f8",ui:{widget:"select",asyncData:()=>this.http.get("//base/service/security/admin/application/list").pipe((0,te.U)(r=>[{label:"\u516c\u53f8\u5217\u8868",group:!0,children:r.data.map(d=>({label:d.name,value:d.id}))}]))}},name:{type:"string",title:"\u83dc\u5355\u540d\u79f0"},menuIcon:{type:"string",title:"\u83dc\u5355\u56fe\u6807"},level:{type:"number",title:"\u83dc\u5355\u7ea7\u522b"},position:{type:"number",title:"\u83dc\u5355\u6392\u5e8f\u4f4d\u7f6e"},url:{type:"string",title:"\u83dc\u5355URL"}},required:["name","url","level","position"]},this.ui={"*":{spanLabelFixed:100,grid:{span:24}}}}ngOnInit(){console.log(this.menu)}save(t){let n="";"add"===this.menu.mode?(t.parentId=this.menu.key,n="//base/service/security/admin/security-resource/menu-create"):"edit"===this.menu.mode&&(t.id=this.menu.id,n="//base/service/security/admin/security-resource/menu-edit"),this.http.post(n,t).subscribe(o=>{o.success?(this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close({})):this.msgSrv.error("\u4fdd\u5b58\u5931\u8d25: "+o.message)})}close(){this.modal.destroy()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.Lf),e.Y36(h.dD),e.Y36(u.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-resource-menu-edit"]],decls:5,vars:4,consts:[[1,"modal-header"],["class","modal-title",4,"ngIf"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-title"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,et,2,1,"div",1),e.YNc(2,tt,2,1,"div",1),e.qZA(),e.YNc(3,nt,1,0,"nz-spin",2),e.YNc(4,it,7,5,"sf",3)),2&t&&(e.xp6(1),e.Q6J("ngIf","add"==n.menu.mode),e.xp6(1),e.Q6J("ngIf","edit"==n.menu.mode),e.xp6(1),e.Q6J("ngIf",!n.menu),e.xp6(1),e.Q6J("ngIf",n.menu))},directives:[p.O5,y.W,v.kJ,g.ix,_.dQ,m.w],encapsulation:2}),i})();function ot(i,s){if(1&i&&(e.TgZ(0,"div",4),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.hij("\u6dfb\u52a0\u83dc\u5355[",t.menuName,"]\u7684\u9875\u9762\u5143\u7d20")}}function st(i,s){if(1&i&&(e.TgZ(0,"div",4),e._uU(1),e.qZA()),2&i){const t=e.oxw();e.xp6(1),e.AsE("\u7f16\u8f91\u83dc\u5355[",t.menuName,"]\u7684\u9875\u9762\u5143\u7d20[",t.pageElement.name,"]")}}function rt(i,s){1&i&&e._UZ(0,"nz-spin",5)}function ct(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"sf",6,7)(2,"div",8)(3,"button",9),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e._uU(4,"\u5173\u95ed"),e.qZA(),e.TgZ(5,"button",10),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().save(o.value)}),e._uU(6," \u4fdd\u5b58 "),e.qZA()()()}if(2&i){const t=e.MAs(1),n=e.oxw();e.Q6J("schema",n.schema)("ui",n.ui)("formData",n.pageElement),e.xp6(5),e.Q6J("disabled",!t.valid)("nzLoading",n.http.loading)}}let ie=(()=>{class i{constructor(t,n,o){this.modal=t,this.msgSrv=n,this.http=o,this.record={},this.menuId="",this.menuName="",this.schema={properties:{name:{type:"string",title:"\u5143\u7d20\u540d\u79f0"},identifier:{type:"string",title:"\u9875\u9762\u5143\u7d20\u6807\u8bc6\u7b26"},applicationId:{type:"string",title:"\u5173\u8054\u7684\u516c\u53f8",ui:{widget:"select",asyncData:()=>this.http.get("//base/service/security/admin/application/list").pipe((0,te.U)(r=>[{label:"\u516c\u53f8\u5217\u8868",group:!0,children:r.data.map(d=>({label:d.name,value:d.id}))}]))}},remark:{type:"string",title:"\u5907\u6ce8",maxLength:140},isPermissionElement:{type:"boolean",title:"\u662f\u5426\u6743\u9650\u6388\u6743\u5143\u7d20",ui:{checkedChildren:"\u662f",unCheckedChildren:"\u5426"}},permissionName:{type:"string",title:"\u6743\u9650\u540d\u79f0",ui:{visibleIf:{isPermissionElement:[!0]}}},permissionIdentifier:{type:"string",title:"\u6743\u9650\u6807\u8bc6\u7b26",ui:{visibleIf:{isPermissionElement:[!0]}}}},required:["name","identifier"]},this.ui={"*":{spanLabelFixed:150},$remark:{widget:"textarea",grid:{span:24}}}}ngOnInit(){null!=this.pageElement.id&&this.http.get("//base/service/security/admin/security-resource/page-element-view",{pageElementId:this.pageElement.id}).subscribe(t=>{t.success?this.pageElement=t.data:this.msgSrv.error("\u6570\u636e\u83b7\u53d6\u5931\u8d25:"+t.message)})}save(t){let n="//base/service/security/admin/security-resource/page-element-create";t.menuId=this.menuId,null!=this.pageElement.id&&(n="//base/service/security/admin/security-resource/page-element-update"),this.http.post(n,t).subscribe(o=>{o.success?(this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(!0)):this.msgSrv.error("\u4fdd\u5b58\u5931\u8d25:"+o.message)})}close(){this.modal.destroy()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.Lf),e.Y36(h.dD),e.Y36(u.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-security-resource-page-element-edit"]],decls:5,vars:4,consts:[[1,"modal-header"],["class","modal-title",4,"ngIf"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-title"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0),e.YNc(1,ot,2,1,"div",1),e.YNc(2,st,2,2,"div",1),e.qZA(),e.YNc(3,rt,1,0,"nz-spin",2),e.YNc(4,ct,7,5,"sf",3)),2&t&&(e.xp6(1),e.Q6J("ngIf",null==n.pageElement.id),e.xp6(1),e.Q6J("ngIf",null!=n.pageElement.id),e.xp6(1),e.Q6J("ngIf",!n.pageElement),e.xp6(1),e.Q6J("ngIf",n.pageElement))},directives:[p.O5,y.W,v.kJ,g.ix,_.dQ,m.w],encapsulation:2}),i})();var B=l(7946),x=l(1894),S=l(7484),M=l(3237),z=l(3677),N=l(4219);const at=["st"];function lt(i,s){}function ut(i,s){1&i&&(e.TgZ(0,"p"),e._uU(1,"\u8bbe\u7f6e\u7cfb\u7edf\u7684\u83dc\u5355\u4fe1\u606f\uff0c\u5e76\u4e14\u53ef\u5728\u914d\u7f6e\u6bcf\u4e2a\u83dc\u5355\u4e2d\u5305\u542b\u7684\u9875\u9762\u6743\u9650\u5143\u7d20\uff0c\u5982\u9700\u8981\u63a7\u5236\u6743\u9650\u7684\u6309\u94ae\u3001Div\u7b49\u3002"),e.qZA())}function dt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"span",23)(1,"i",24),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().openFolder(o)}),e.qZA(),e.TgZ(2,"span",25),e._uU(3),e.qZA(),e.TgZ(4,"span",26)(5,"a",27)(6,"i",28),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().optMenu(o)}),e.qZA()()()()}if(2&i){const t=e.oxw().$implicit,n=e.MAs(4);e.xp6(1),e.Q6J("nzType",t.isExpanded?"folder-open":"folder"),e.xp6(2),e.hij(" ",t.title," "),e.xp6(2),e.Q6J("nzDropdownMenu",n)}}function pt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"span",23),e._UZ(1,"i",29),e.TgZ(2,"span",30),e._uU(3),e.qZA(),e.TgZ(4,"span",26)(5,"a",27)(6,"i",28),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().optMenu(o)}),e.qZA()()()()}if(2&i){const t=e.oxw().$implicit,n=e.MAs(4);e.xp6(3),e.Oqu(t.title),e.xp6(2),e.Q6J("nzDropdownMenu",n)}}function mt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"span",13),e.YNc(1,dt,7,3,"span",14),e.YNc(2,pt,7,2,"span",14),e.TgZ(3,"nz-dropdown-menu",null,15)(5,"ul",16)(6,"li",17),e._uU(7),e.qZA(),e._UZ(8,"li",18),e.TgZ(9,"li",19),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().menuOperation("edit",r)}),e._UZ(10,"i",20),e._uU(11,"\u4fee\u6539"),e.qZA(),e.TgZ(12,"li",19),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().menuOperation("add",r)}),e._UZ(13,"i",21),e._uU(14,"\u6dfb\u52a0\u4e0b\u7ea7\u83dc\u5355"),e.qZA(),e.TgZ(15,"li",19),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().menuOperation("remove",r)}),e._UZ(16,"i",22),e._uU(17,"\u5220\u9664"),e.qZA()()()()}if(2&i){const t=s.$implicit,n=e.oxw();e.ekj("active",(null==n.activedMenuNode?null:n.activedMenuNode.key)===t.key),e.xp6(1),e.Q6J("ngIf",!t.isLeaf),e.xp6(1),e.Q6J("ngIf",t.isLeaf),e.xp6(5),e.hij("\u7f16\u8f91\u83dc\u5355: ",n.optMenuName,"")}}function ht(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",31),e.NdJ("click",function(){return e.CHM(t),e.oxw().createPageElementResource()}),e._UZ(1,"i",32),e._uU(2,"\u6dfb\u52a0"),e.qZA()}}let be=(()=>{class i{constructor(t,n,o,r,c){this.http=t,this.modal=n,this.msgSrv=o,this.cdr=r,this.modalSrv=c,this.menuNodes=[],this.optMenuId="",this.optMenuName="\u65e0",this.orgTreeLoading=!0,this.url="//base/service/security/admin/authority/permission/page-element-table",this.searchSchema={properties:{no:{type:"string",title:"\u7f16\u53f7"}}},this.pageElementCustomRequest={allInBody:!0,method:"POST",reName:{pi:"page",ps:"pageSize"},params:{menuId:this.optMenuId}},this.pageElementCustomPage={zeroIndexed:!0,pageSizes:[100],front:!1,showSize:!0,showQuickJumper:!0},this.columns=[{title:"\u5143\u7d20\u540d\u79f0",index:"name"},{title:"\u9875\u9762\u6807\u8bc6\u7b26",index:"identifier"},{title:"\u6743\u9650\u53d7\u63a7",index:"isPermissionElement",type:"badge"},{title:"\u6743\u9650\u540d\u79f0",index:"permissionName"},{title:"\u6743\u9650\u6807\u8bc6\u7b26",index:"permissionIdentifier"},{title:"\u5907\u6ce8",index:"remark"},{title:"",buttons:[{text:"\u7f16\u8f91",type:"static",icon:"edit",click:a=>this.updatePageElementResource(a)},{text:"\u5220\u9664",type:"static",icon:"delete",click:a=>{this.confirmModal=this.modalSrv.confirm({nzTitle:"\u5220\u9664\u786e\u8ba4?",nzContent:"\u662f\u5426\u786e\u8ba4\u5220\u9664\u5143\u7d20 ["+a.name+"] ?",nzOnOk:()=>{this.http.post("//base/service/security/admin/security-resource/page-element-delete",a).subscribe(d=>{d.success&&(this.msgSrv.success("\u5220\u9664\u6210\u529f"),this.loadPageElementResourceTable(this.optMenuId))})}})}}]}]}loadPageElementResourceTable(t){this.st.reload({menuId:this.optMenuId})}ngOnInit(){this.loadMenuTree()}menuEvent(t){const n=t.node;"click"===t.eventName&&(this.activedMenuNode=n,this.optMenuId=n.key,this.optMenuName=n.title,this.loadPageElementResourceTable(this.optMenuId),this.activedMenuNode=n)}loadMenuTree(){this.orgTreeLoading=!0,this.http.get("//base/service/security/admin/security-resource/menu-tree?menuId=root").subscribe(t=>{t.success&&(this.menuNodes=t.data.tree,this.orgTreeLoading=!1,this.cdr.detectChanges())})}optMenu(t){this.activedMenuNode=t,this.optMenuId=t.key,this.optMenuName=t.title}openFolder(t){}menuOperation(t,n){"add"===t?this.modal.createStatic(ne,{menu:{key:n.key,title:n.title,mode:"add"}},{size:"md"}).subscribe(()=>{this.loadMenuTree(),this.cdr.detectChanges()}):"edit"===t?this.modal.createStatic(ne,{menu:{id:n.key,name:n.title,url:n.origin.url,level:n.origin.level,position:n.origin.position,menuIcon:n.origin.icon,mode:"edit"}},{size:"md"}).subscribe(()=>{this.loadMenuTree()}):"remove"===t&&(this.confirmModal=this.modalSrv.confirm({nzTitle:"\u5220\u9664\u786e\u8ba4?",nzContent:"\u662f\u5426\u786e\u8ba4\u5220\u9664\u83dc\u5355 ["+n.title+"] ?",nzOnOk:()=>{this.http.post("//base/service/security/admin/security-resource/menu-delete",{menuId:n.key}).subscribe(r=>{r.success?(this.msgSrv.success("\u5220\u9664\u6210\u529f"),this.loadMenuTree()):this.msgSrv.error(r.message)})}}))}createPageElementResource(){null==this.optMenuId||""===this.optMenuId?this.msgSrv.warning("\u8bf7\u5148\u9009\u4e2d\u83dc\u5355\uff0c\u518d\u6dfb\u52a0\u9875\u9762\u5143\u7d20!"):this.modal.createStatic(ie,{pageElement:{},menuId:this.optMenuId,menuName:this.optMenuName},{size:"md"}).subscribe(()=>this.st.reload())}updatePageElementResource(t){this.modal.createStatic(ie,{pageElement:t,menuId:this.optMenuId,menuName:this.optMenuName},{size:"md"}).subscribe(()=>this.st.reload())}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.lP),e.Y36(u.Te),e.Y36(h.dD),e.Y36(e.sBO),e.Y36(f.Sf))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-security-resource-menu"]],viewQuery:function(t,n){if(1&t&&e.Gf(at,5),2&t){let o;e.iGM(o=e.CRH())&&(n.st=o.first)}},decls:17,vars:12,consts:[[3,"title","breadcrumb","content"],["breadcrumb",""],["content",""],["nz-row","","nzGutter","18"],["nz-col","","nzSpan","6"],["nzTitle","\u83dc\u5355\u5217\u8868"],["nzExpandAll","true","nzVirtualHeight","580px",3,"nzData","nzAsyncData","nzTreeTemplate","nzExpandChange","nzClick","nzDblClick"],["nzTreeTemplate",""],["nz-col","","nzSpan","18"],[3,"nzTitle","nzExtra"],["ps","100",3,"data","columns","req","page"],["st",""],["extraTemplate",""],[1,"custom-node"],["class","custom-node-item",4,"ngIf"],["orgOptMenu","nzDropdownMenu"],["nz-menu",""],["nz-menu-item","","nzDisabled",""],["nz-menu-divider",""],["nz-menu-item","",3,"click"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-icon","","nzType","plus-circle","nzTheme","outline"],["nz-icon","","nzType","delete","nzTheme","outline"],[1,"custom-node-item"],["nz-icon","",3,"nzType","click"],[1,"folder-name"],[1,"file-desc"],["nz-dropdown","","nzTrigger","hover",3,"nzDropdownMenu"],["nz-icon","","nzType","menu","nzTheme","outline",3,"click"],["nz-icon","","nzType","file"],[1,"file-name"],["nz-button","","nzType","primary",3,"click"],["nz-icon","","nzType","plus"]],template:function(t,n){if(1&t&&(e.TgZ(0,"page-header",0),e.YNc(1,lt,0,0,"ng-template",null,1,e.W1O),e.YNc(3,ut,2,0,"ng-template",null,2,e.W1O),e.qZA(),e.TgZ(5,"div",3)(6,"div",4)(7,"nz-card",5)(8,"nz-tree",6),e.NdJ("nzExpandChange",function(r){return n.menuEvent(r)})("nzClick",function(r){return n.menuEvent(r)})("nzDblClick",function(r){return n.menuEvent(r)}),e.qZA(),e.YNc(9,mt,18,5,"ng-template",null,7,e.W1O),e.qZA()(),e.TgZ(11,"div",8)(12,"nz-card",9),e._UZ(13,"st",10,11),e.qZA(),e.YNc(15,ht,3,0,"ng-template",null,12,e.W1O),e.qZA()()),2&t){const o=e.MAs(2),r=e.MAs(4),c=e.MAs(10),a=e.MAs(16);e.Q6J("title","\u83dc\u5355\u7ba1\u7406")("breadcrumb",o)("content",r),e.xp6(8),e.Q6J("nzData",n.menuNodes)("nzAsyncData","true")("nzTreeTemplate",c),e.xp6(4),e.Q6J("nzTitle","\u9875\u9762\u6743\u9650\u8d44\u6e90 : "+n.optMenuName)("nzExtra",a),e.xp6(1),e.Q6J("data",n.url)("columns",n.columns)("req",n.pageElementCustomRequest)("page",n.pageElementCustomPage)}},directives:[B.q,x.SK,x.t3,S.bd,M.Hc,p.O5,m.w,D.Ls,z.Ws,z.cm,z.RR,N.wO,N.r9,N.YV,k.A5,g.ix,_.dQ],styles:["[_nghost-%COMP%]     .ant-tree{overflow:hidden;margin:0 -24px;padding:0 24px}[_nghost-%COMP%]     .ant-tree li{padding:4px 0 0}.custom-node[_ngcontent-%COMP%]{cursor:pointer;line-height:24px;margin-left:4px;display:inline-block}.custom-node[_ngcontent-%COMP%]:hover{background-color:#ccc}.custom-node[_ngcontent-%COMP%]:hover   .file-desc[_ngcontent-%COMP%], .custom-node[_ngcontent-%COMP%]:hover   .folder-desc[_ngcontent-%COMP%]{display:inline-block}.active[_ngcontent-%COMP%]{color:#1890ff;font-weight:700}.node-operation[_ngcontent-%COMP%]{color:#666;display:inline-block;padding:0 8px;display:block;line-height:24px;position:relative;left:12px}.file-name[_ngcontent-%COMP%], .folder-name[_ngcontent-%COMP%]{margin-left:4px}.file-desc[_ngcontent-%COMP%], .folder-desc[_ngcontent-%COMP%]{padding:0 8px;position:relative;left:4px;display:none}"]}),i})();function gt(i,s){1&i&&e._UZ(0,"nz-spin",4)}function _t(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e._uU(4,"\u5173\u95ed"),e.qZA(),e.TgZ(5,"button",9),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().save(o.value)}),e._uU(6," \u4fdd\u5b58 "),e.qZA()()()}if(2&i){const t=e.MAs(1),n=e.oxw();e.Q6J("schema",n.schema)("ui",n.ui)("formData",n.formData),e.xp6(5),e.Q6J("disabled",!t.valid)("nzLoading",n.http.loading)}}let oe=(()=>{class i{constructor(t,n,o){this.modal=t,this.msgSrv=n,this.http=o,this.modalTitle="",this.formData={},this.schema={properties:{name:{type:"string",title:"\u89d2\u8272\u540d\u79f0"},remark:{type:"string",title:"\u63cf\u8ff0"}},required:["name"]},this.ui={"*":{spanLabelFixed:100},$remark:{widget:"textarea"}}}ngOnInit(){"add"===this.mode?this.modalTitle="\u6dfb\u52a0\u89d2\u8272":"edit"===this.mode&&(this.formData=this.editNode,this.modalTitle="\u7f16\u8f91\u89d2\u8272 ["+this.formData.name+"]")}save(t){let n="//base/service/security/admin/authority/role/create";"add"===this.mode?t.parentId=this.editNode.key:"edit"===this.mode&&(n="//base/service/security/admin/authority/role/edit-name"),this.http.post(n,t).subscribe(o=>{o.success?(this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(!0)):this.msgSrv.error(o.message)})}close(){this.modal.destroy()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.Lf),e.Y36(h.dD),e.Y36(u.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-security-role-edit"]],decls:5,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA()(),e.YNc(3,gt,1,0,"nz-spin",2),e.YNc(4,_t,7,5,"sf",3)),2&t&&(e.xp6(2),e.Oqu(n.modalTitle),e.xp6(1),e.Q6J("ngIf",!n.formData),e.xp6(1),e.Q6J("ngIf",n.formData))},directives:[p.O5,y.W,v.kJ,g.ix,_.dQ,m.w],encapsulation:2}),i})(),ft=(()=>{class i{constructor(t,n){this.http=t,this.settingsService=n}}return i.\u0275fac=function(t){return new(t||i)(e.LFG(u.lP),e.LFG(u.gb))},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();var se=l(685),w=l(868);const Ct=["roleTreeComponent"],yt=["st"],vt=function(){return{x:"1000pxpx"}};function xt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",1)(1,"div",2)(2,"button",3),e.NdJ("click",function(){return e.CHM(t),e.oxw().saveCheckMenu()}),e._uU(3,"\u4fdd\u5b58"),e.qZA(),e.TgZ(4,"nz-tree",4,5),e.NdJ("nzClick",function(o){return e.CHM(t),e.oxw().menuEvent(o)})("nzExpandChange",function(o){return e.CHM(t),e.oxw().menuEvent(o)})("nzCheckBoxChange",function(o){return e.CHM(t),e.oxw().menuEvent(o)}),e.qZA()(),e.TgZ(6,"div",6)(7,"div",7)(8,"span",8),e._uU(9),e.qZA()(),e._UZ(10,"st",9,10),e.qZA()()}if(2&i){const t=e.oxw();e.xp6(4),e.Q6J("nzData",t.menuNodes)("nzCheckedKeys",t.defaultCheckedKeys),e.xp6(5),e.hij("\u9875\u9762\u6743\u9650\u8d44\u6e90: ",t.optMenuName,""),e.xp6(1),e.Q6J("data",t.url)("scroll",e.DdM(6,vt))("columns",t.columns)}}let re=(()=>{class i{constructor(t,n,o,r,c){this.http=t,this.modal=n,this.msgSrv=o,this.cdr=r,this.modalSrv=c,this.defaultCheckedKeys=[],this.checkedMenuIds=[],this.checkedPermissionIds=[],this.checkedMenuPermissionMap=new Map,this.menuNodes=[],this.optMenuId="",this.optMenuName="\u65e0",this.orgTreeLoading=!0,this.halfCheckedIds=[],this.url="//base/service/security/admin/authority/permission/page-element-table",this.searchSchema={properties:{no:{type:"string",title:"\u7f16\u53f7"}}},this.pageElementCustomRequest={allInBody:!0,method:"POST",reName:{pi:"page",ps:"pageSize"},params:{menuId:this.optMenuId}},this.pageElementCustomPage={zeroIndexed:!0,pageSizes:[100],front:!1,showSize:!0,showQuickJumper:!0},this.columns=[{title:"",type:"checkbox",index:"permissionId"},{title:"\u5143\u7d20\u540d\u79f0",index:"name"},{title:"\u9875\u9762\u6807\u8bc6\u7b26",index:"identifier"},{title:"\u6743\u9650\u53d7\u63a7",index:"isPermissionElement",type:"badge"},{title:"\u6743\u9650\u540d\u79f0",index:"permissionName"},{title:"\u6743\u9650\u6807\u8bc6\u7b26",index:"permissionIdentifier"},{title:"\u5907\u6ce8",index:"remark"}]}loadPageElementResourceTable(t){null!=this.st&&this.st.reload({menuId:this.optMenuId})}ngOnInit(){}ngOnChanges(t){console.log("\u6d4b\u8bd5:",this.role),this.loadMenuTree()}permissionTableChange(t){if("checkbox"===t.type){const n=[];for(const o of t.checkbox){if(!this.checkedMenuPermissionMap.has(o.menuId))return this.msgSrv.error("\u8bf7\u9009\u4e2d\u8be5\u6743\u9650\u6240\u5c5e\u7684\u83dc\u5355!"),void this.st.clearCheck();n.push(o.permissionId)}this.updatePermissionCheck(t.checkbox),this.updateCheckIds()}}menuEvent(t){const n=t.node;if("click"===t.eventName||"dblclick"===t.eventName)this.optMenuId=n.key,this.optMenuName=n.title,this.loadPageElementResourceTable(this.optMenuId),this.activedMenuNode=n;else if("check"===t.eventName){const o=this.getCheckedMenuIds(this.roleTreeComponent.getCheckedNodeList());console.log("checkedMenuIdArray:",o),this.updateMenuCheckNodes(o),this.updateCheckIds()}}loadMenuTree(){this.orgTreeLoading=!0,this.http.get("//base/service/security/admin/security-resource/menu-tree?menuId=root&roleId="+this.role.id).subscribe(t=>{t.success&&(console.log("res.data:",t.data),this.defaultCheckedKeys=t.data.selectedKeys,console.log("defaultCheckedKeys:",this.defaultCheckedKeys),this.menuNodes=t.data.tree,this.orgTreeLoading=!1,this.cdr.detectChanges())})}optMenu(t){this.activedMenuNode=t,this.optMenuId=t.key,this.optMenuName=t.title}updateMenuCheckNodes(t){if(t.size>0){const n=new Array;this.checkedMenuPermissionMap.forEach((o,r)=>{t.has(r)||n.push(r)}),n.forEach(o=>this.checkedMenuPermissionMap.delete(o)),t.forEach(o=>{this.checkedMenuPermissionMap.has(o)||this.checkedMenuPermissionMap.set(o,new Set)})}else this.checkedMenuPermissionMap.clear()}getCheckedMenuIds(t){const n=new Set("");return console.log("treeNodes",t),t.forEach((o,r)=>{n.add(o.key),o.children.length>0&&this.getCheckedMenuIds(o.children).forEach(c=>{n.add(c)})}),n}updatePermissionCheck(t){const n=new Set;t.length>0&&(t.forEach(o=>{n.add(o.permissionId)}),this.checkedMenuPermissionMap.set(t[0].menuId,n))}updateCheckIds(){this.checkedMenuIds=[],this.checkedPermissionIds=[],this.checkedMenuPermissionMap.forEach((t,n,o)=>{this.checkedMenuIds.push(n),t.forEach(r=>this.checkedPermissionIds.push(r))}),this.cdr.detectChanges()}saveCheckMenu(){const t=this.roleTreeComponent.getHalfCheckedNodeList();if(console.log("checkedMenuIds:",this.checkedMenuIds),console.log("this.checkedMenuIds.length:",this.checkedMenuIds.length),0===this.checkedMenuIds.length)return void this.msgSrv.warning("\u6ca1\u6709\u4fee\u6539\u4efb\u4f55\u83dc\u5355\u6743\u9650,\u8bf7\u6539\u53d8\u6570\u636e\u540e\u63d0\u4ea4\uff01");console.log("halfChecked:",t),t.forEach((o,r)=>{console.log("value:",o.key,"has:",r),this.halfCheckedIds.push(o.key)});const n={roleId:this.role.id,menuResourceIds:this.checkedMenuIds.join(","),permissionIds:this.checkedPermissionIds.join(","),halfCheckedIds:this.halfCheckedIds.join(",")};console.log("requestParams:",n),this.http.post("//base/service/security/admin/authority/role/assign-permissions",n).subscribe(o=>{this.msgSrv.success(o.message)})}nzEvent(t){console.log(t)}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.lP),e.Y36(u.Te),e.Y36(h.dD),e.Y36(e.sBO),e.Y36(f.Sf))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-security-resource-menu-check"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Ct,5),e.Gf(yt,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.roleTreeComponent=o.first),e.iGM(o=e.CRH())&&(n.st=o.first)}},inputs:{role:"role"},features:[e.TTD],decls:1,vars:1,consts:[["nz-row","","nzGutter","18",4,"ngIf"],["nz-row","","nzGutter","18"],["nz-col","","nzSpan","6",2,"width","100px","overflow-x","auto"],["nz-button","","nzType","primary","nzBlock","",3,"click"],["nzCheckable","",3,"nzData","nzCheckedKeys","nzClick","nzExpandChange","nzCheckBoxChange"],["roleTreeComponent",""],["nz-col","","nzSpan","18"],["nz-row",""],[2,"font-size","16px","font-weight","bolder"],[3,"data","scroll","columns"],["st",""]],template:function(t,n){1&t&&e.YNc(0,xt,12,7,"div",0),2&t&&e.Q6J("ngIf",null!=n.role)},directives:[p.O5,x.SK,x.t3,g.ix,_.dQ,m.w,M.Hc,k.A5],styles:["[_nghost-%COMP%]     .ant-tree{overflow:hidden;margin:0 -24px;padding:0 24px}[_nghost-%COMP%]     .ant-tree li{padding:4px 0 0}.custom-node[_ngcontent-%COMP%]{cursor:pointer;line-height:24px;margin:0 -1000px;padding:0 1000px;display:inline-block}.custom-node[_ngcontent-%COMP%]:hover{background-color:#ccc}.custom-node[_ngcontent-%COMP%]:hover   .file-desc[_ngcontent-%COMP%], .custom-node[_ngcontent-%COMP%]:hover   .folder-desc[_ngcontent-%COMP%]{display:inline-block}.active[_ngcontent-%COMP%]{color:#1890ff;font-weight:700}.node-operation[_ngcontent-%COMP%]{color:#666;display:inline-block;padding:0 8px;display:block;line-height:24px;position:relative;left:12px}.file-name[_ngcontent-%COMP%], .folder-name[_ngcontent-%COMP%]{margin-left:4px}.file-desc[_ngcontent-%COMP%], .folder-desc[_ngcontent-%COMP%]{padding:0 8px;position:relative;left:4px;display:none}"]}),i})();var Tt={}.toString;const H=function(i,s){return Tt.call(i)==="[object "+s+"]"},ce=function(i){return H(i,"Function")},ae=function kt(i,s){if(i)if(function(i){return Array.isArray?Array.isArray(i):H(i,"Array")}(i))for(var n=0,o=i.length;n<o&&!1!==s(i[n],n);n++);else if(function(i){var s=typeof i;return null!==i&&"object"===s||"function"===s}(i))for(var r in i)if(i.hasOwnProperty(r)&&!1===s(i[r],r))break};Math,parseInt,Math;const Jt=Object.values?function(i){return Object.values(i)}:function(i){var s=[];return ae(i,function(t,n){ce(i)&&"prototype"===n||s.push(t)}),s};var $,F=l(655);function qt(i,s){1&i&&e._UZ(0,"nz-spin",4)}function jt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e._uU(4,"\u5173\u95ed"),e.qZA(),e.TgZ(5,"button",9),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().save(o.value)}),e._uU(6," \u4fdd\u5b58 "),e.qZA()()()}if(2&i){const t=e.MAs(1),n=e.oxw();e.Q6J("schema",n.schema)("formData",n.i),e.xp6(5),e.Q6J("disabled",!t.valid)("nzLoading",n.http.loading)}}!function(i,s){if(!ce(i))throw new TypeError("Expected a function");var t=function(){for(var n=[],o=0;o<arguments.length;o++)n[o]=arguments[o];var r=s?s.apply(this,n):n[0],c=t.cache;if(c.has(r))return c.get(r);var a=i.apply(this,n);return c.set(r,a),a};t.cache=new Map}(function(i,s){void 0===s&&(s={});var t=s.fontSize,n=s.fontFamily,o=s.fontWeight,r=s.fontStyle,c=s.fontVariant;return $||($=document.createElement("canvas").getContext("2d")),$.font=[r,c,o,t+"px",n].join(" "),$.measureText(function(i){return H(i,"String")}(i)?i:"").width},function(i,s){return void 0===s&&(s={}),(0,F.pr)([i],Jt(s)).join("")}),function(){function i(){this.map={}}i.prototype.has=function(s){return void 0!==this.map[s]},i.prototype.get=function(s,t){var n=this.map[s];return void 0===n?t:n},i.prototype.set=function(s,t){this.map[s]=t},i.prototype.clear=function(){this.map={}},i.prototype.delete=function(s){delete this.map[s]},i.prototype.size=function(){return Object.keys(this.map).length}}();let Ee=(()=>{class i{constructor(t,n,o){this.modal=t,this.msgSrv=n,this.http=o,this.record={},this.schema={properties:{name:{type:"string",title:"\u6743\u9650\u7ec4\u540d\u79f0"}},required:["name"]},this.ui={"*":{spanLabelFixed:150},$name:{widget:"string"},$remark:{widget:"textarea"}}}ngOnInit(){void 0!==this.record.id&&this.http.get(`//base/service/security/admin/application/${this.record.id}`).subscribe(t=>{t.success&&(this.i=t.data)})}save(t){this.http.post("//base/service/security/admin/scopePermission/create",t).subscribe(n=>{n.success?(this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(!0)):this.msgSrv.error(n.message)})}close(){this.modal.destroy()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.Lf),e.Y36(h.dD),e.Y36(u.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-security-data-permissions-edit"]],decls:5,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA()(),e.YNc(3,qt,1,0,"nz-spin",2),e.YNc(4,jt,7,4,"sf",3)),2&t&&(e.xp6(2),e.hij("\u7f16\u8f91 ",n.record.name," \u4fe1\u606f"),e.xp6(1),e.Q6J("ngIf",!n.i),e.xp6(1),e.Q6J("ngIf",n.i))},directives:[p.O5,y.W,v.kJ,g.ix,_.dQ,m.w],encapsulation:2}),i})();const Ht=["dataPermissionsTreeComponent"];function Vt(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",10),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().optDataPermission(r)}),e.TgZ(1,"div",11)(2,"span",12),e._uU(3),e.qZA()()()}if(2&i){const t=s.$implicit,n=e.oxw();e.ekj("active",n.selectedScope.id==t.id),e.xp6(3),e.Oqu(t.name)}}function $t(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"span",15)(1,"i",16),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().openFolder(o)}),e.qZA(),e.TgZ(2,"span",17),e._uU(3),e.qZA()()}if(2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("nzType",t.isExpanded?"folder-open":"folder"),e.xp6(2),e.hij(" ",t.title," ")}}function Gt(i,s){if(1&i&&(e.TgZ(0,"span",15),e._UZ(1,"i",18),e.TgZ(2,"span",19),e._uU(3),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(3),e.Oqu(t.title)}}function Wt(i,s){if(1&i&&(e.TgZ(0,"span",13),e.YNc(1,$t,4,2,"span",14),e.YNc(2,Gt,4,1,"span",14),e.qZA()),2&i){const t=s.$implicit,n=e.oxw();e.ekj("active",(null==n.activedOrgNode?null:n.activedOrgNode.key)===t.key),e.xp6(1),e.Q6J("ngIf",!t.isLeaf),e.xp6(1),e.Q6J("ngIf",t.isLeaf)}}let le=(()=>{class i{constructor(t,n,o,r){this.http=t,this.modal=n,this.msgSrv=o,this.cdr=r,this.checkedOrgIds=[],this.checkedPermissionIds=[],this.selectedScope=null,this.appList=[{name:"\u7ec4\u7ec7\u673a\u6784",id:"1",category:"org"},{name:"\u7ad9\u70b9",id:"2",category:"station"},{name:"\u7ebf\u8def",id:"2",category:"line"}],this.checkedDataPermissionMap=new Map,this.optOrgId=null,this.optOrgName=null,this.orgTreeLoading=!0,this.selectedOrgId=null,this.orgNodes=[]}ngOnChanges(t){}loadAppList(){this.selectedScope={}}optDataPermission(t){this.selectedScope=t,this.loadOrgTree()}saveRolePermission(){const t={roleId:this.role.id,scopeId:this.selectedScope.id,checkedOrgIds:this.checkedOrgIds.join(),category:this.selectedScope.category};this.http.post("//base/service/security/admin/scopePermission/update",t).subscribe(n=>{n.success&&this.msgSrv.success(n.message)})}addPermissionScope(){this.modal.createStatic(Ee,{record:{},i:{}},{size:"md"}).subscribe(t=>{this.loadAppList()})}orgEvent(t){const n=t.node;if("expand"===t.eventName)n&&0===n.getChildren().length&&n.isExpanded&&this.http.get("/org/service/organization/admin/organization/tree/child/"+n.key+"/"+n.origin.corpId).subscribe(o=>{o.success&&n.addChildren(o.data)});else if("click"!==t.eventName&&"check"===t.eventName){const o=this.getCheckedMenuIds(this.dataPermissionsTreeComponent.getCheckedNodeList());this.updateDataPermissionsCheckNodes(o),this.updateCheckIds()}}getCheckedMenuIds(t){const n=new Set("");return t.forEach((o,r)=>{n.add(o.key),o.children.length>0&&this.getCheckedMenuIds(o.children).forEach(c=>{n.add(c)})}),n}updateDataPermissionsCheckNodes(t){if(t.size>0){const n=new Array;this.checkedDataPermissionMap.forEach((o,r)=>{t.has(r)||n.push(r)}),n.forEach(o=>this.checkedDataPermissionMap.delete(o)),t.forEach(o=>{this.checkedDataPermissionMap.has(o)||this.checkedDataPermissionMap.set(o,new Set)})}else this.checkedDataPermissionMap.clear()}updateCheckIds(){this.checkedOrgIds=[],this.checkedPermissionIds=[],this.checkedDataPermissionMap.forEach((t,n,o)=>{this.checkedOrgIds.push(n),t.forEach(r=>this.checkedPermissionIds.push(r))}),this.cdr.detectChanges()}loadOrgTree(){this.http.get("/org/service/organization/admin/organization/tree/child/root").subscribe(t=>{t.success&&(this.orgNodes=[],""!=this.selectedScope.orgIds&&null!=this.selectedScope.orgIds?t.data.forEach(n=>{const o=this.orgTree1(n,this.selectedScope.orgIds);this.orgNodes.push(o),console.log("orgNode:",o)}):this.orgNodes=t.data,this.cdr.detectChanges(),console.log("this.orgNodes:",this.orgNodes),this.orgTreeLoading=!1)})}orgTree1(t,n){return-1!=n.indexOf(t.key)&&(t.checked=!0),ae(t.children,o=>{t.children.concat(this.orgTree1(o,n))}),t}openFolder(t){}ngOnInit(){this.loadAppList()}add(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.lP),e.Y36(u.Te),e.Y36(h.dD),e.Y36(e.sBO))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-data-permissions"]],viewQuery:function(t,n){if(1&t&&e.Gf(Ht,5),2&t){let o;e.iGM(o=e.CRH())&&(n.dataPermissionsTreeComponent=o.first)}},inputs:{role:"role"},features:[e.TTD],decls:18,vars:4,consts:[["nz-col","",3,"nzSpan"],[1,"app-list"],["class","app",3,"active","click",4,"ngFor","ngForOf"],["nz-row",""],["nzCheckable","","nzMultiple","",3,"nzData","nzClick","nzExpandChange","nzCheckBoxChange"],["dataPermissionsTreeComponent",""],["nzTreeTemplate",""],["nz-row","",1,"permission-operation"],["nz-button","","nzType","primary",3,"click"],["nz-button","","nzType","default",2,"margin-right","10px"],[1,"app",3,"click"],[1,"app-content"],[1,"app-title"],[1,"custom-node"],["class","custom-node-item",4,"ngIf"],[1,"custom-node-item"],["nz-icon","",3,"nzType","click"],[1,"folder-name"],["nz-icon","","nzType","file"],[1,"file-name"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"nz-card")(2,"div",1),e.YNc(3,Vt,4,3,"div",2),e.qZA(),e.TgZ(4,"nz-card"),e.ynx(5),e.TgZ(6,"div",3)(7,"h3"),e._uU(8),e.qZA()(),e.TgZ(9,"nz-tree",4,5),e.NdJ("nzClick",function(r){return n.orgEvent(r)})("nzExpandChange",function(r){return n.orgEvent(r)})("nzCheckBoxChange",function(r){return n.orgEvent(r)}),e.qZA(),e.YNc(11,Wt,3,4,"ng-template",null,6,e.W1O),e.TgZ(13,"div",7)(14,"button",8),e.NdJ("click",function(){return n.saveRolePermission()}),e._uU(15,"\u4fdd\u5b58"),e.qZA(),e.TgZ(16,"button",9),e._uU(17,"\u53d6\u6d88"),e.qZA()(),e.BQk(),e.qZA()()()),2&t&&(e.Q6J("nzSpan",24),e.xp6(3),e.Q6J("ngForOf",n.appList),e.xp6(5),e.hij("[",n.selectedScope.name,"] \u6743\u9650\u8303\u56f4\u6811"),e.xp6(1),e.Q6J("nzData",n.orgNodes))},directives:[x.t3,S.bd,p.sg,x.SK,M.Hc,p.O5,m.w,D.Ls,g.ix,_.dQ],styles:["[_nghost-%COMP%]     .ant-tree{overflow:hidden;margin:0 -24px;padding:0 24px}[_nghost-%COMP%]     .ant-tree li{padding:4px 0 0}.custom-node[_ngcontent-%COMP%]{cursor:pointer;line-height:24px;margin-left:4px;display:inline-block}.file-name[_ngcontent-%COMP%], .folder-name[_ngcontent-%COMP%]{margin-left:4px}.file-desc[_ngcontent-%COMP%], .folder-desc[_ngcontent-%COMP%]{padding:0 8px;display:inline-block;background:#87ceff;color:#fff;position:relative;left:12px}.app-list[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:start;flex-wrap:wrap}.app[_ngcontent-%COMP%]{width:180px;display:flex;background:#ffffff;box-shadow:0 1px 6px #8181812e;padding:10px;margin-right:10px;margin-bottom:10px;align-self:center;border-radius:5px}.active[_ngcontent-%COMP%]{background:#1890ff;color:#fff}.active-tag[_ngcontent-%COMP%]{color:#1890ff;font-weight:700}.app-logo[_ngcontent-%COMP%]{margin-right:10px}.app-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-self:center}.app-title[_ngcontent-%COMP%]{font-size:14px;text-align:center}.app-desc[_ngcontent-%COMP%]{color:#999;font-size:12px}.permission-list[_ngcontent-%COMP%]{margin-top:10px;border:1px #cccccc solid;padding:10px 20px}.permission-operation[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row-reverse;margin-top:20px;padding-top:10px}"]}),i})();const Xt=["st"];function Kt(i,s){1&i&&e._UZ(0,"nz-spin",4)}function en(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"sf",5,6)(2,"nz-card")(3,"sf",7),e.NdJ("formSubmit",function(o){return e.CHM(t),e.MAs(5).reset(o)})("formReset",function(o){return e.CHM(t),e.MAs(5).reset(o)}),e.qZA(),e.TgZ(4,"st",8,9),e.NdJ("change",function(o){return e.CHM(t),e.oxw().change(o)}),e.qZA()(),e.TgZ(6,"div",10)(7,"button",11),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e._uU(8,"\u5173\u95ed"),e.qZA(),e.TgZ(9,"button",12),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().save(o.value)}),e._uU(10," \u4fdd\u5b58 "),e.qZA()()()}if(2&i){const t=e.MAs(1),n=e.oxw();e.Q6J("schema",n.schema)("formData",n.i),e.xp6(3),e.Q6J("schema",n.searchSchema),e.xp6(1),e.Q6J("data",n.url)("columns",n.columns),e.xp6(5),e.Q6J("disabled",!t.valid)("nzLoading",n.http.loading)}}let ue=(()=>{class i{constructor(t,n,o){this.http=t,this.modal=n,this.msgSrv=o,this.schema={properties:{},required:[]},this.ui={"*":{spanLabelFixed:100,grid:{span:12}},$no:{widget:"text"},$href:{widget:"string"},$description:{widget:"textarea",grid:{span:24}}},this.url="//base/service/security/admin/actor/user/findUserSearch",this.searchSchema={properties:{name:{type:"string",title:"\u7528\u6237\u540d\u79f0"}}},this.columns=[{title:"\u7f16\u53f7",index:"id",type:"checkbox"},{title:"\u540d\u79f0",index:"name",width:"100px"},{title:"\u767b\u9646\u8d26\u53f7",index:"account",width:"100px"},{title:"\u624b\u673a\u53f7",index:"mobilePhone",width:"100px"}]}ngOnInit(){this.st.req.body={roleId:this.i.roleId,selected:!0}}add(){}change(t){console.log("change",t),"click"===t.type&&this.st._data.map(n=>{n.id===t.click.item.id&&(n.checked=!n.checked)})}close(){this.modal.destroy()}save(t){let n=new Array;this.st._data.map(o=>{o.checked&&n.push(o.id)}),console.log("checkedIds:",n),t.userIds=n,t.roleId=this.i.roleId,this.http.post("//base/service/security/admin/authorization/batch-assign-role-to-user",t).subscribe(o=>{o.success?(this.msgSrv.success("\u89d2\u8272\u6388\u6743\u6210\u529f"),this.modal.close(!0)):this.msgSrv.error(o.message)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.lP),e.Y36(f.Lf),e.Y36(h.dD))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-check-user-table"]],viewQuery:function(t,n){if(1&t&&e.Gf(Xt,5),2&t){let o;e.iGM(o=e.CRH())&&(n.st=o.first)}},decls:5,vars:2,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","formData"],["sf",""],["mode","search",3,"schema","formSubmit","formReset"],[3,"data","columns","change"],["st",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"\u9009\u4e2d\u7528\u6237\u6388\u6743\u89d2\u8272"),e.qZA()(),e.YNc(3,Kt,1,0,"nz-spin",2),e.YNc(4,en,11,7,"sf",3)),2&t&&(e.xp6(3),e.Q6J("ngIf",!n.i),e.xp6(1),e.Q6J("ngIf",n.i))},directives:[p.O5,y.W,v.kJ,S.bd,k.A5,g.ix,_.dQ,m.w],encapsulation:2}),i})();const tn=["sf"],nn=["st"],on=function(){return{x:"1300px"}};let de=(()=>{class i{constructor(t,n,o,r,c){this.http=t,this.modal=n,this.settingsService=o,this.messageService=r,this.nzModal=c,this.record={},this.url="/org/service/organization/admin/account/findByActorCondition",this.searchSchema={properties:{name:{type:"string",title:"\u7528\u6237\u540d\u79f0"}}},this.columns=[{title:"\u540d\u79f0",index:"name",width:"100px"},{title:"\u767b\u9646\u8d26\u53f7",index:"account",width:"100px"},{title:"\u90ae\u7bb1",index:"email",width:"100px"},{title:"\u624b\u673a\u53f7",index:"mobilePhone",width:"100px"},{title:"\u64cd\u4f5c",width:"100px",buttons:[{text:"\u5220\u9664",tooltip:"\u5220\u9664",type:"del",icon:"delete",click:(a,d,C)=>{this.http.delete("//base/service/security/admin/authorization/delete",{userId:a.id,roleId:this.role.id}).subscribe(T=>{this.messageService.success(`\u6210\u529f\u79fb\u9664\u3010${a.name}\u3011\u89d2\u8272\u6743\u9650`),this.st.reload()},T=>{this.messageService.success(`\u79fb\u9664\u5931\u8d25\u3010${a.name}\u3011`)})}}]}]}ngAfterViewInit(){}searchName(){this.st.req.body={roleId:this.role.id},this.st.reload()}addUserRole(){this.modal.createStatic(ue,{i:{roleId:this.role.id},mode:"add"}).subscribe(()=>{this.st.req.body={roleId:this.role.id},this.st.reload()})}transferToNormalRole(){this.nzModal.confirm({nzTitle:"\u786e\u5b9a\u8981\u8d4b\u4e88\u6240\u6709\u4eba"+this.role.name+"\u7684\u89d2\u8272\u5417?",nzContent:"\u6b64\u64cd\u4f5c\u4f1a\u628a\u6240\u6709\u4eba\u8d4b\u4e88\u89d2\u8272\u6743\u9650,\u8bf7\u8c28\u614e\u64cd\u4f5c!",nzOnOk:()=>{this.http.post("//base/service/security/admin/authorization/transferToNormalRole",{roleId:this.role.id}).subscribe(t=>{this.messageService.success("\u6240\u6709\u4eba\u8d4b\u4e88"+this.role.name+"\u89d2\u8272\u6210\u529f"),this.st.req.body={roleId:this.role.id},this.st.reload()})}})}reset(){this.sf.reset(),this.sf.refreshSchema()}ngOnChanges(t){this.reloadTable()}reloadTable(){3==this.role.index&&(this.st.req.body={roleId:this.role.id},this.st.reload())}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.lP),e.Y36(u.Te),e.Y36(u.gb),e.Y36(h.dD),e.Y36(f.Sf))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-user-permission"]],viewQuery:function(t,n){if(1&t&&(e.Gf(tn,5),e.Gf(nn,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.sf=o.first),e.iGM(o=e.CRH())&&(n.st=o.first)}},inputs:{role:"role"},features:[e.TTD],decls:13,vars:7,consts:[["mode","search",3,"button","schema","formSubmit","formReset"],["sf",""],["type","submit","nz-button","","nzType","primary",3,"disabled"],["type","button","nz-button","",3,"click"],["nz-button","","nzType","primary",3,"click"],[3,"data","scroll","columns"],["st",""]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"nz-card")(1,"sf",0,1),e.NdJ("formSubmit",function(c){return e.CHM(o),e.MAs(12).reset(c)})("formReset",function(c){return e.CHM(o),e.MAs(12).reset(c)}),e.TgZ(3,"button",2),e._uU(4,"\u641c\u7d22"),e.qZA(),e.TgZ(5,"button",3),e.NdJ("click",function(){return n.reset()}),e._uU(6,"\u91cd\u7f6e"),e.qZA(),e.TgZ(7,"button",4),e.NdJ("click",function(){return n.addUserRole()}),e._uU(8,"\u6388\u6743\u7528\u6237\u89d2\u8272"),e.qZA(),e.TgZ(9,"button",4),e.NdJ("click",function(){return n.transferToNormalRole()}),e._uU(10,"\u4e00\u952e\u8f6c\u89d2\u8272"),e.qZA()(),e._UZ(11,"st",5,6),e.qZA()}if(2&t){const o=e.MAs(2);e.xp6(1),e.Q6J("button",null)("schema",n.searchSchema),e.xp6(2),e.Q6J("disabled",!o.valid),e.xp6(8),e.Q6J("data",n.url)("scroll",e.DdM(6,on))("columns",n.columns)}},directives:[S.bd,v.kJ,g.ix,_.dQ,m.w,k.A5],encapsulation:2}),i})();const sn=["appUsePermission"];function rn(i,s){}function cn(i,s){1&i&&(e.TgZ(0,"p"),e._uU(1,'\u5c06\u7528\u6237\u5206\u914d\u5230\u5404\u4e2a\u89d2\u8272\u4e2d\uff0c\u7528\u6237\u5373\u83b7\u5f97\u4e86\u8be5\u89d2\u8272\u62e5\u6709\u7684\u6743\u9650\u3002\u89d2\u8272\u91c7\u7528\u5c42\u7ea7\u7ed3\u6784\uff0c\u6839\u7ea7\u522b\u4e3a"\u6700\u4f4e\u6743\u9650"\u89d2\u8272\uff0c\u4e0b\u7ea7\u89d2\u8272\u5c06\u81ea\u52a8\u7ee7\u627f\u4e0a\u7ea7\u89d2\u8272\u7684\u6743\u9650'),e.qZA())}function an(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"span",21)(1,"i",22),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().openFolder(o)}),e.qZA(),e.TgZ(2,"span",23),e._uU(3),e.qZA(),e.TgZ(4,"span",24)(5,"a",25)(6,"i",26),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().optRole(o)}),e.qZA()()()()}if(2&i){const t=e.oxw().$implicit,n=e.MAs(4);e.xp6(1),e.Q6J("nzType",t.isExpanded?"folder-open":"folder"),e.xp6(2),e.hij(" ",t.title," "),e.xp6(2),e.Q6J("nzDropdownMenu",n)}}function ln(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"span",21),e._UZ(1,"i",27),e.TgZ(2,"span",28),e._uU(3),e.qZA(),e.TgZ(4,"span",24)(5,"a",25)(6,"i",26),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw().optRole(o)}),e.qZA()()()()}if(2&i){const t=e.oxw().$implicit,n=e.MAs(4);e.xp6(3),e.Oqu(t.title),e.xp6(2),e.Q6J("nzDropdownMenu",n)}}function un(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"span",11),e.YNc(1,an,7,3,"span",12),e.YNc(2,ln,7,2,"span",12),e.TgZ(3,"nz-dropdown-menu",null,13)(5,"ul",14)(6,"li",15),e._uU(7),e.qZA(),e._UZ(8,"li",16),e.TgZ(9,"li",17),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().roleOperation("edit",r)}),e._UZ(10,"i",18),e._uU(11,"\u4fee\u6539"),e.qZA(),e.TgZ(12,"li",17),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().roleOperation("add",r)}),e._UZ(13,"i",19),e._uU(14,"\u6dfb\u52a0\u89d2\u8272"),e.qZA(),e.TgZ(15,"li",17),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().roleOperation("remove",r)}),e._UZ(16,"i",20),e._uU(17,"\u5220\u9664"),e.qZA()()()()}if(2&i){const t=s.$implicit,n=e.oxw();e.ekj("active",(null==n.activeRoleNode?null:n.activeRoleNode.key)===t.key),e.xp6(1),e.Q6J("ngIf",!t.isLeaf),e.xp6(1),e.Q6J("ngIf",t.isLeaf),e.xp6(5),e.hij("\u7f16\u8f91\u89d2\u8272: ",t.title,"")}}function dn(i,s){1&i&&e._UZ(0,"nz-empty",29)}function pn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"nz-tabset",30),e.NdJ("nzSelectChange",function(o){return e.CHM(t),e.oxw().nzSelectChange(o)}),e.TgZ(1,"nz-tab",31),e._UZ(2,"app-setup-security-resource-menu-check",32),e.qZA(),e.TgZ(3,"nz-tab",33),e._UZ(4,"app-setup-data-permissions",32),e.qZA(),e.TgZ(5,"nz-tab",34),e._UZ(6,"app-setup-user-permission",32,35),e.qZA()()}if(2&i){const t=e.oxw();e.Q6J("nzSelectedIndex",t.index),e.xp6(1),e.Q6J("nzForceRender",!0),e.xp6(1),e.Q6J("role",t.selectedRole),e.xp6(1),e.Q6J("nzForceRender",!0),e.xp6(1),e.Q6J("role",t.selectedRole),e.xp6(1),e.Q6J("nzForceRender",!0),e.xp6(1),e.Q6J("role",t.selectedRole)}}let Ae=(()=>{class i{constructor(t,n,o,r,c,a,d){this.http=t,this.modal=n,this.messageService=o,this.modalSrv=r,this.cdr=c,this.router=a,this.permissionService=d,this.roleNodes=[],this.roleTreeLoading=!0,this.index=0,this.roleList=[],this.roleTitle="",this.selectedRole=null}ngOnInit(){this.loadRoleTree(),this.index=0}roleEvent(t){"click"===t.eventName&&(this.activeRoleNode=t.node,this.activeRole(this.activeRoleNode,this.index))}loadRoleTree(){this.roleTreeLoading=!0,this.http.get("//base/service/security/admin/authority/role/role-tree").subscribe(t=>{t.success&&(this.roleNodes=t.data,this.roleTreeLoading=!1,this.cdr.detectChanges())})}optRole(t){this.activeRoleNode=t}openFolder(t){}roleOperation(t,n){console.log("node:",n),"add"===t?this.modal.createStatic(oe,{editNode:n,mode:"add"},{size:"md"}).subscribe(()=>{this.loadRoleTree()}):"edit"===t?this.modal.createStatic(oe,{editNode:{id:n.key,name:n.title,remark:n.origin.remark},mode:"edit"},{size:"md"}).subscribe(()=>{this.loadRoleTree()}):"remove"===t&&(this.confirmModal=this.modalSrv.confirm({nzTitle:"\u5220\u9664\u786e\u8ba4?",nzContent:"\u662f\u5426\u786e\u8ba4\u5220\u9664\u89d2\u8272 ["+n.title+"] ?",nzOnOk:()=>{this.http.post("//base/service/security/admin/authority/role/delete/"+n.key).subscribe(r=>{r.success?(this.messageService.success("\u5220\u9664\u6210\u529f"),this.loadRoleTree()):this.messageService.error("\u5220\u9664\u5931\u8d25 : "+r.message)})}}))}loadRoleList(){this.http.get("/service/contact/admin/role/list").subscribe(t=>{t.success&&(this.roleList=t.data)})}activeRole(t,n){this.cdr.reattach(),this.index=n,this.selectedRole={id:t.key,name:t.title,index:this.index},this.roleTitle=this.selectedRole.name}nzSelectChange(t){this.index=t.index,this.selectedRole.index=t.index,this.sf.reloadTable()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.lP),e.Y36(u.Te),e.Y36(h.dD),e.Y36(f.Sf),e.Y36(e.sBO),e.Y36(Z.F0),e.Y36(ft))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-security-role-permission"]],viewQuery:function(t,n){if(1&t&&e.Gf(sn,5),2&t){let o;e.iGM(o=e.CRH())&&(n.sf=o.first)}},decls:15,vars:11,consts:[["title","\u89d2\u8272\u6743\u9650",3,"content","breadcrumb"],["breadcrumb",""],["content",""],["nz-row","",3,"nzGutter"],["nz-col","",3,"nzSpan"],["nzTitle","\u89d2\u8272\u5173\u7cfb"],["nzExpandAll","true","nzShowLine","",3,"nzData","nzAsyncData","nzTreeTemplate","nzClick"],["nzTreeTemplate",""],[3,"nzTitle"],["nzNotFoundContent","\u8bf7\u5148\u9009\u62e9\u89d2\u8272",4,"ngIf"],[3,"nzSelectedIndex","nzSelectChange",4,"ngIf"],[1,"custom-node"],["class","custom-node-item",4,"ngIf"],["roleOptMenu",""],["nz-menu",""],["nz-menu-item","","nzDisabled",""],["nz-menu-divider",""],["nz-menu-item","",3,"click"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-icon","","nzType","plus-circle","nzTheme","outline"],["nz-icon","","nzType","delete","nzTheme","outline"],[1,"custom-node-item"],["nz-icon","",3,"nzType","click"],[1,"folder-name"],[1,"file-desc"],["nz-dropdown","","nzTrigger","click",3,"nzDropdownMenu"],["nz-icon","","nzType","menu","nzTheme","outline",3,"click"],["nz-icon","","nzType","file"],[1,"file-name"],["nzNotFoundContent","\u8bf7\u5148\u9009\u62e9\u89d2\u8272"],[3,"nzSelectedIndex","nzSelectChange"],["nzTitle","\u529f\u80fd\u6743\u9650",3,"nzForceRender"],[3,"role"],["nzTitle","\u6570\u636e\u6743\u9650",3,"nzForceRender"],["nzTitle","\u7528\u6237\u6388\u6743",3,"nzForceRender"],["appUsePermission",""]],template:function(t,n){if(1&t&&(e.TgZ(0,"page-header",0),e.YNc(1,rn,0,0,"ng-template",null,1,e.W1O),e.YNc(3,cn,2,0,"ng-template",null,2,e.W1O),e.qZA(),e.TgZ(5,"div",3)(6,"div",4)(7,"nz-card",5)(8,"nz-tree",6),e.NdJ("nzClick",function(r){return n.roleEvent(r)}),e.qZA(),e.YNc(9,un,18,5,"ng-template",null,7,e.W1O),e.qZA()(),e.TgZ(11,"div",4)(12,"nz-card",8),e.YNc(13,dn,1,0,"nz-empty",9),e.YNc(14,pn,8,7,"nz-tabset",10),e.qZA()()()),2&t){const o=e.MAs(2),r=e.MAs(4),c=e.MAs(10);e.Q6J("content",r)("breadcrumb",o),e.xp6(5),e.Q6J("nzGutter",18),e.xp6(1),e.Q6J("nzSpan",4),e.xp6(2),e.Q6J("nzData",n.roleNodes)("nzAsyncData","true")("nzTreeTemplate",c),e.xp6(3),e.Q6J("nzSpan",20),e.xp6(1),e.Q6J("nzTitle","\u6388\u6743\u4fe1\u606f: "+n.roleTitle),e.xp6(1),e.Q6J("ngIf",null==n.selectedRole),e.xp6(1),e.Q6J("ngIf",null!=n.selectedRole)}},directives:[B.q,x.SK,x.t3,S.bd,M.Hc,p.O5,m.w,D.Ls,z.Ws,z.cm,z.RR,N.wO,N.r9,N.YV,se.p9,w.xH,w.xw,re,le,de],styles:["[_nghost-%COMP%]     .ant-tree{overflow:hidden;margin:0 -24px;padding:0 24px}[_nghost-%COMP%]     .ant-tree li{padding:4px 0 0}.custom-node[_ngcontent-%COMP%]{cursor:pointer;line-height:24px;margin-left:4px;display:inline-block}.custom-node[_ngcontent-%COMP%]:hover{background-color:#ccc}.custom-node[_ngcontent-%COMP%]:hover   .file-desc[_ngcontent-%COMP%], .custom-node[_ngcontent-%COMP%]:hover   .folder-desc[_ngcontent-%COMP%]{display:inline-block}.active[_ngcontent-%COMP%]{color:#1890ff;font-weight:700}.node-operation[_ngcontent-%COMP%]{color:#666;display:inline-block;padding:0 8px;display:block;line-height:24px;position:relative;left:12px}.file-name[_ngcontent-%COMP%], .folder-name[_ngcontent-%COMP%]{margin-left:4px}.file-desc[_ngcontent-%COMP%], .folder-desc[_ngcontent-%COMP%]{padding:0 8px;position:relative;left:4px;display:none}"]}),i})();const mn=["sf"];function hn(i,s){1&i&&e._UZ(0,"nz-spin",4)}function gn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e._uU(4,"\u5173\u95ed"),e.qZA(),e.TgZ(5,"button",9),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().save(o.value)}),e._uU(6," \u4fdd\u5b58 "),e.qZA()()()}if(2&i){const t=e.MAs(1),n=e.oxw();e.Q6J("schema",n.schema)("formData",n.i),e.xp6(5),e.Q6J("disabled",!t.valid)("nzLoading",n.http.loading)}}let we=(()=>{class i{constructor(t,n,o){this.modal=t,this.msgSrv=n,this.http=o,this.record={},this.schema={properties:{name:{type:"string",title:"\u5e94\u7528\u540d\u79f0"},category:{type:"string",title:"\u5e94\u7528\u7c7b\u578b",enum:[{label:"\u4f01\u4e1a\u5fae\u4fe1",value:"wxcp"},{label:"\u4f01\u4e1a\u5c0f\u7a0b\u5e8f",value:"miniapp"},{label:"\u9489\u9489",value:"ding"},{label:"\u4e91\u4e4b\u5bb6",value:"yzj"},{label:"\u540e\u53f0\u5e94\u7528",value:"admin"}],default:"wxcp",ui:{widget:"select"}},corpId:{type:"string",title:"\u7b2c\u4e09\u65b9\u5e94\u7528CorpId"},remark:{type:"string",title:"\u63cf\u8ff0",maxLength:140}},required:["name","category"]},this.ui={"*":{spanLabelFixed:150},$name:{widget:"string"},$remark:{widget:"textarea"}}}ngOnInit(){void 0!==this.record.id&&this.http.get(`//base/service/security/admin/application/${this.record.id}`).subscribe(t=>{t.success&&(this.i=t.data)})}save(t){var n;let r=null===(n=this.sf.getProperty("/category").schema.enum)||void 0===n?void 0:n.find(c=>c.value==t.category);console.log("category:",r),t.categoryName=r.label,this.http.post("//base/service/security/admin/application/add",t).subscribe(c=>{c.success?(this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(!0)):this.msgSrv.error(c.message)})}close(){this.modal.destroy()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.Lf),e.Y36(h.dD),e.Y36(u.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-security-app-permissions-edit"]],viewQuery:function(t,n){if(1&t&&e.Gf(mn,5),2&t){let o;e.iGM(o=e.CRH())&&(n.sf=o.first)}},decls:5,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA()(),e.YNc(3,hn,1,0,"nz-spin",2),e.YNc(4,gn,7,4,"sf",3)),2&t&&(e.xp6(2),e.hij("\u7f16\u8f91 ",n.record.name," \u4fe1\u606f"),e.xp6(1),e.Q6J("ngIf",!n.i),e.xp6(1),e.Q6J("ngIf",n.i))},directives:[p.O5,y.W,v.kJ,g.ix,_.dQ,m.w],encapsulation:2}),i})();var _n=l(6114),E=l(2382);function fn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",6),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw().optAppPermission(r)}),e.TgZ(1,"div",7),e._UZ(2,"img",8),e.qZA(),e.TgZ(3,"div",9)(4,"span",10),e._uU(5),e.qZA(),e.TgZ(6,"span",11),e._uU(7),e.qZA()()()}if(2&i){const t=s.$implicit,n=e.oxw();e.ekj("active",n.selectedApp.id==t.id),e.xp6(5),e.Oqu(t.name),e.xp6(2),e.Oqu(t.description)}}function Cn(i,s){1&i&&e._UZ(0,"nz-empty")}function yn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",16)(1,"label",17),e.NdJ("nzCheckedChange",function(){const r=e.CHM(t).$implicit;return e.oxw(2).changeRolePermission(r)}),e._uU(2),e.qZA()()}if(2&i){const t=s.$implicit;e.xp6(1),e.Q6J("nzValue",t.value)("ngModel",t.checked),e.xp6(1),e.Oqu(t.label)}}function vn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",18)(1,"button",4),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).saveRolePermission()}),e._uU(2,"\u4fdd\u5b58"),e.qZA(),e.TgZ(3,"button",19),e._uU(4,"\u53d6\u6d88"),e.qZA()()}}function xn(i,s){if(1&i&&(e.ynx(0),e.TgZ(1,"div",12)(2,"h3"),e._uU(3),e.qZA()(),e.TgZ(4,"div",13),e.YNc(5,yn,3,3,"div",14),e.qZA(),e.YNc(6,vn,5,0,"div",15),e.BQk()),2&i){const t=e.oxw();e.xp6(3),e.hij("[",t.selectedApp.name,"] \u6743\u9650\u9879\u76ee\u5217\u8868"),e.xp6(2),e.Q6J("ngForOf",t.roleAppPermissions),e.xp6(1),e.Q6J("ngIf",0!=t.roleAppPermissions.length)}}let Pe=(()=>{class i{constructor(t,n,o){this.http=t,this.modal=n,this.msgSrv=o,this.selectedApp=null,this.appList=[],this.roleAppPermissions=[],this.assignPartyEmployeeButton=!1}ngOnChanges(t){2==this.role.index&&null!=this.selectedApp&&this.loadRoleAppPermission()}loadAppList(){this.selectedApp={},this.http.get("//base/service/security/admin/application/list").subscribe(t=>{t.success&&(this.appList=t.data,this.appList.length>0&&this.optAppPermission(this.appList[0]))})}optAppPermission(t){console.log("\u9009\u62e9\u5e94\u7528\uff1a\uff1a\uff1a\uff1a\uff1a",t),this.selectedApp=t,this.roleAppPermissions=[],this.loadRoleAppPermission()}loadRoleAppPermission(){this.http.post("//base/service/security/admin/authority/role/permission/list/all",{roleId:this.role.id,applicationId:this.selectedApp.id}).subscribe(n=>{console.log("\u6743\u9650\u8d44\u6e90:",n),n.success&&(this.roleAppPermissions=n.data)})}changeRolePermission(t){this.roleAppPermissions.map(n=>{n.value==t.value&&(n.checked=!t.checked)})}saveRolePermission(){this.http.post("//base/service/security/admin/authority/role/updateRolePermissionsByButton",{roleId:this.role.id,appId:this.selectedApp.id,permissions:this.roleAppPermissions}).subscribe(n=>{n.success&&(this.msgSrv.success(n.message),this.loadRoleAppPermission())})}addApp(){this.modal.createStatic(we,{record:{},i:{}},{size:"md"}).subscribe(t=>{})}ngOnInit(){console.log("app")}add(){}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.lP),e.Y36(u.Te),e.Y36(h.dD))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-app-permissions"]],inputs:{role:"role"},features:[e.TTD],decls:11,vars:5,consts:[["nz-row","",3,"nzGutter"],["nz-col","",3,"nzSpan"],[1,"app-list"],["class","app",3,"active","click",4,"ngFor","ngForOf"],["nz-button","","nzType","primary",3,"click"],[4,"ngIf"],[1,"app",3,"click"],[1,"app-logo"],["src","http://wework.qpic.cn/bizmail/hoew4PTXG3u0fJUZjw5uYrVYRc3tR2esphAa0nhZ6PR7SibQ9el4sKw/0",2,"width","36px","height","36px"],[1,"app-content"],[1,"app-title"],[1,"app-desc"],["nz-row",""],["nz-row","",1,"permission-list"],["nz-col","","nzSpan","6","style","margin-bottom: 5px",4,"ngFor","ngForOf"],["nz-row","","class","permission-operation",4,"ngIf"],["nz-col","","nzSpan","6",2,"margin-bottom","5px"],["nz-checkbox","",3,"nzValue","ngModel","nzCheckedChange"],["nz-row","",1,"permission-operation"],["nz-button","","nzType","default",2,"margin-right","10px"]],template:function(t,n){1&t&&(e.TgZ(0,"nz-card")(1,"div",0)(2,"div",1)(3,"nz-card")(4,"div",2),e.YNc(5,fn,8,4,"div",3),e.TgZ(6,"button",4),e.NdJ("click",function(){return n.addApp()}),e._uU(7,"\u6dfb\u52a0\u5e94\u7528"),e.qZA()(),e.TgZ(8,"nz-card"),e.YNc(9,Cn,1,0,"nz-empty",5),e.YNc(10,xn,7,3,"ng-container",5),e.qZA()()()()()),2&t&&(e.xp6(1),e.Q6J("nzGutter",6),e.xp6(1),e.Q6J("nzSpan",24),e.xp6(3),e.Q6J("ngForOf",n.appList),e.xp6(4),e.Q6J("ngIf",0==n.roleAppPermissions.length),e.xp6(1),e.Q6J("ngIf",0!=n.roleAppPermissions.length))},directives:[S.bd,x.SK,x.t3,p.sg,g.ix,_.dQ,m.w,p.O5,se.p9,_n.Ie,E.JJ,E.On],styles:["[_nghost-%COMP%]     .ant-tree{overflow:hidden;margin:0 -24px;padding:0 24px}[_nghost-%COMP%]     .ant-tree li{padding:4px 0 0}.custom-node[_ngcontent-%COMP%]{cursor:pointer;line-height:24px;display:inline-block;margin:0 -1000px;padding:0 1000px}.file-name[_ngcontent-%COMP%], .folder-name[_ngcontent-%COMP%]{margin-left:4px}.file-desc[_ngcontent-%COMP%], .folder-desc[_ngcontent-%COMP%]{padding:0 8px;display:inline-block;background:#87ceff;color:#fff;position:relative;left:12px}.app-list[_ngcontent-%COMP%]{width:100%;display:flex;justify-content:start;flex-wrap:wrap}.app[_ngcontent-%COMP%]{width:180px;display:flex;background:#ffffff;box-shadow:0 1px 6px #8181812e;padding:10px;margin-right:10px;margin-bottom:10px;align-self:center;border-radius:5px}.active[_ngcontent-%COMP%]{background:#1890ff;color:#fff}.active-tag[_ngcontent-%COMP%]{color:#1890ff;font-weight:700}.app-logo[_ngcontent-%COMP%]{margin-right:10px}.app-content[_ngcontent-%COMP%]{display:flex;flex-direction:column;align-self:center}.app-title[_ngcontent-%COMP%]{font-size:14px}.app-desc[_ngcontent-%COMP%]{color:#999;font-size:12px}.permission-list[_ngcontent-%COMP%]{margin-top:10px;border:1px #cccccc solid;padding:10px 20px}.permission-operation[_ngcontent-%COMP%]{width:100%;display:flex;flex-direction:row-reverse;margin-top:20px;padding-top:10px}"]}),i})();function Sn(i,s){1&i&&e._UZ(0,"nz-spin",4)}function kn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e._uU(4,"\u5173\u95ed"),e.qZA(),e.TgZ(5,"button",9),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().save(o.value)}),e._uU(6," \u4fdd\u5b58 "),e.qZA()()()}if(2&i){const t=e.MAs(1),n=e.oxw();e.Q6J("schema",n.schema)("ui",n.ui)("formData",n.i),e.xp6(5),e.Q6J("disabled",!t.valid)("nzLoading",n.http.loading)}}l(9676);let pe=(()=>{class i{constructor(t,n,o){this.modal=t,this.msgSrv=n,this.http=o,this.organization={},this.title="",this.schema={properties:{name:{type:"string",title:"\u7f16\u53f7"},remark:{type:"string",title:"\u63cf\u8ff0",maxLength:140}},required:["owner","callNo","href","description"]},this.ui={"*":{spanLabelFixed:100},$description:{widget:"textarea"}}}ngOnInit(){console.log(this.organization),"add"===this.organization.mode?(this.title="["+this.organization.name+"] \u6dfb\u52a0\u4e0b\u7ea7\u90e8\u95e8",this.i={}):"edit"===this.organization.mode&&(this.title="\u7f16\u8f91 ["+this.organization.name+"] ",this.i=this.organization)}save(t){"add"===this.organization.mode?this.http.post("/service/contact/admin/organization/create",{parentId:this.organization.id,name:t.name,remark:t.remark}).subscribe(o=>{this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(!0)}):"edit"===this.organization.mode&&this.http.post("/service/contact/admin/organization/edit",{id:this.organization.id,name:t.name,remark:t.remark}).subscribe(o=>{this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(!0)})}close(){this.modal.destroy()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.Lf),e.Y36(h.dD),e.Y36(u.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-system-contact-org-edit"]],decls:5,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA()(),e.YNc(3,Sn,1,0,"nz-spin",2),e.YNc(4,kn,7,5,"sf",3)),2&t&&(e.xp6(2),e.Oqu(n.title),e.xp6(1),e.Q6J("ngIf",!n.i),e.xp6(1),e.Q6J("ngIf",n.i))},directives:[p.O5,y.W,v.kJ,g.ix,_.dQ,m.w],encapsulation:2}),i})();function Nn(i,s){1&i&&e._UZ(0,"nz-spin",4)}function Dn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e._uU(4,"\u5173\u95ed"),e.qZA(),e.TgZ(5,"button",9),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().save(o.value)}),e._uU(6," \u4fdd\u5b58 "),e.qZA()()()}if(2&i){const t=e.MAs(1),n=e.oxw();e.Q6J("schema",n.schema)("ui",n.ui)("formData",n.postData),e.xp6(5),e.Q6J("disabled",!t.valid)("nzLoading",n.http.loading)}}let me=(()=>{class i{constructor(t,n,o){this.modal=t,this.msgSrv=n,this.http=o,this.record={},this.postData={},this.schema={properties:{name:{type:"string",title:"\u6807\u7b7e\u540d\u79f0"},remark:{type:"string",title:"\u6807\u7b7e\u63cf\u8ff0",maxLength:140}},required:["name"]},this.ui={"*":{spanLabelFixed:100,grid:{span:12}},$name:{widget:"string"},$remark:{widget:"textarea",grid:{span:24}}}}ngOnInit(){null!=this.record.id&&this.http.get("/service/contact/admin/tag/"+this.record.id).subscribe(t=>{t.success&&(this.postData=t.data)})}save(t){this.http.post("/service/contact/admin/tag/add",t).subscribe(n=>{this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modal.close(!0)})}close(){this.modal.destroy()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(f.Lf),e.Y36(h.dD),e.Y36(u.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-system-contact-tag-edit"]],decls:5,vars:3,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA()(),e.YNc(3,Nn,1,0,"nz-spin",2),e.YNc(4,Dn,7,5,"sf",3)),2&t&&(e.xp6(2),e.hij("\u7f16\u8f91 ",n.record.id," \u4fe1\u606f"),e.xp6(1),e.Q6J("ngIf",!n.postData),e.xp6(1),e.Q6J("ngIf",n.postData))},directives:[p.O5,y.W,v.kJ,g.ix,_.dQ,m.w],encapsulation:2}),i})();const Mn=["sf"];function En(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"sf",3,4)(2,"div",5)(3,"button",6),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e._uU(4,"\u5173\u95ed"),e.qZA(),e.TgZ(5,"button",7),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().save(o.value)}),e._uU(6,"\u4fdd\u5b58"),e.qZA()()()}if(2&i){const t=e.oxw();e.Q6J("schema",t.schema)("ui",t.ui)("formData",t.i)}}let G=(()=>{class i{constructor(t,n,o,r){this.modal=t,this.modalRef=n,this.msgSrv=o,this.http=r,this.record={},this.attendanceGroupEmployeeData=[],this.schema={properties:{mobilePhone:{type:"string",title:"\u624b\u673a\u53f7",format:"mobile"},name:{type:"string",title:"\u59d3\u540d"},password:{type:"string",title:"\u5bc6\u7801"}},required:["mobilePhone","name","password"]},this.ui={"*":{spanLabelFixed:100,grid:{span:12}},$no:{widget:"text"},$href:{widget:"string"},$description:{widget:"textarea",grid:{span:24}}}}ngOnInit(){}save(t){t.account=t.mobilePhone;let n="register";this.i.id&&(n="updateUser"),this.http.post("//base/service/security/admin/actor/user/"+n,t).subscribe(o=>{o.success?(this.msgSrv.success("\u4fdd\u5b58\u6210\u529f"),this.modalRef.close(!0)):this.msgSrv.error(o.message)})}selectUser(){console.log(this.mode)}close(){this.modalRef.destroy()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.Te),e.Y36(f.Lf),e.Y36(h.dD),e.Y36(u.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-account-edit"]],viewQuery:function(t,n){if(1&t&&e.Gf(Mn,5),2&t){let o;e.iGM(o=e.CRH())&&(n.sf=o.first)}},decls:4,vars:2,consts:[[1,"modal-header"],[1,"modal-title"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2),e.qZA()(),e.YNc(3,En,7,3,"sf",2)),2&t&&(e.xp6(2),e.hij("\u7f16\u8f91 ",n.record.id," \u4fe1\u606f"),e.xp6(1),e.Q6J("ngIf",n.i))},directives:[p.O5,v.kJ,g.ix,_.dQ,m.w],encapsulation:2}),i})();var R=l(1047),L=l(5482);const An=["st"];function wn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",16),e.NdJ("click",function(){return e.CHM(t),e.oxw().selectUser()}),e._uU(1,"\u65b0\u5efa"),e.qZA()}}function Pn(i,s){1&i&&(e.TgZ(0,"div",17),e._UZ(1,"nz-spin",18),e.qZA())}function On(i,s){1&i&&e._UZ(0,"i",19)}function In(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"span",35)(1,"i",36),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).openFolder(o)}),e.qZA(),e.TgZ(2,"span",37),e._uU(3),e.qZA(),e.TgZ(4,"span",38),e._UZ(5,"a",39),e.qZA()()}if(2&i){const t=e.oxw().$implicit,n=e.MAs(4);e.xp6(1),e.Q6J("nzType",t.isExpanded?"folder-open":"folder"),e.xp6(2),e.hij(" ",t.title," "),e.xp6(2),e.Q6J("nzDropdownMenu",n)}}function Zn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"span",35),e._UZ(1,"i",40),e.TgZ(2,"span",41),e._uU(3),e.qZA(),e.TgZ(4,"span",38)(5,"a",39)(6,"i",42),e.NdJ("click",function(){e.CHM(t);const o=e.oxw().$implicit;return e.oxw(2).optOrg(o)}),e.qZA()()()()}if(2&i){const t=e.oxw().$implicit,n=e.MAs(4);e.xp6(3),e.Oqu(t.title),e.xp6(2),e.Q6J("nzDropdownMenu",n)}}function Fn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"span",24),e.YNc(1,In,6,3,"span",25),e.YNc(2,Zn,7,2,"span",25),e.TgZ(3,"nz-dropdown-menu",null,26)(5,"ul",27)(6,"li",28),e._uU(7),e.qZA(),e._UZ(8,"li",29),e.TgZ(9,"li",30),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).orgOperation("add",r)}),e._UZ(10,"i",31),e._uU(11,"\u6dfb\u52a0\u4e0b\u7ea7\u90e8\u95e8 "),e.qZA(),e.TgZ(12,"li",30),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).orgOperation("edit-name",r)}),e._UZ(13,"i",32),e._uU(14,"\u4fee\u6539\u540d\u79f0"),e.qZA(),e.TgZ(15,"li",30),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).orgOperation("remove",r)}),e._UZ(16,"i",33),e._uU(17,"\u5220\u9664"),e.qZA(),e.TgZ(18,"li",30),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(2).orgOperation("setup-post",r)}),e._UZ(19,"i",34),e._uU(20,"\u8bbe\u7f6e\u5c97\u4f4d "),e.qZA()()()()}if(2&i){const t=s.$implicit,n=e.oxw(2);e.ekj("active",(null==n.activedOrgNode?null:n.activedOrgNode.key)===t.key),e.xp6(1),e.Q6J("ngIf",!t.isLeaf),e.xp6(1),e.Q6J("ngIf",t.isLeaf),e.xp6(5),e.hij("\u7f16\u8f91\u90e8\u95e8: ",n.optOrgName,"")}}function Jn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"nz-tabset",20),e.NdJ("nzSelectedIndexChange",function(o){return e.CHM(t),e.oxw().activeTab(o)}),e.TgZ(1,"nz-tab",21)(2,"nz-tree",22),e.NdJ("nzExpandChange",function(o){return e.CHM(t),e.oxw().orgEvent(o)})("nzClick",function(o){return e.CHM(t),e.oxw().orgEvent(o)})("nzDblClick",function(o){return e.CHM(t),e.oxw().orgEvent(o)}),e.qZA(),e.YNc(3,Fn,21,5,"ng-template",null,23,e.W1O),e.qZA()()}if(2&i){const t=e.MAs(4),n=e.oxw();e.Q6J("nzSize","small"),e.xp6(2),e.Q6J("nzData",n.orgNodes)("nzAsyncData","true")("nzTreeTemplate",t)}}function Rn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"p",47),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).searchResult(r)}),e._uU(1),e.qZA()}if(2&i){const t=s.$implicit;e.xp6(1),e.hij(" ",t.name," ")}}function Ln(i,s){if(1&i&&(e.TgZ(0,"nz-collapse-panel",45),e.YNc(1,Rn,2,1,"p",46),e.qZA()),2&i){const t=s.$implicit;e.Q6J("nzHeader",t.name)("nzActive",t.active),e.xp6(1),e.Q6J("ngForOf",t.childPanel)}}function Bn(i,s){if(1&i&&(e.TgZ(0,"div")(1,"nz-collapse",43),e.YNc(2,Ln,2,3,"nz-collapse-panel",44),e.qZA()()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("nzBordered",!1),e.xp6(1),e.Q6J("ngForOf",t.panels)}}function Un(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",49),e.NdJ("click",function(){return e.CHM(t),e.oxw(2).addAccount()}),e._UZ(1,"i",50),e._uU(2,"\u6dfb\u52a0\u975e\u540c\u6b65\u7684\u5176\u5b83\u8d26\u53f7 "),e.qZA()}}function Yn(i,s){if(1&i&&e.YNc(0,Un,3,0,"button",48),2&i){const t=e.oxw();e.Q6J("ngIf",t.showAssignEmployeeButton)}}const Qn=function(){return{x:"1300px"}};let Oe=(()=>{class i{constructor(t,n,o,r,c,a){this.http=t,this.router=n,this.modal=o,this.modalSrv=r,this.msgSrv=c,this.nzContextMenuService=a,this.showSearchResult=!1,this.searchValue="",this.activeTabIndex=0,this.panels=[],this.employeeTableTitle="\u3010\u7ec4\u7ec7\u4eba\u5458\u4fe1\u606f\u3011",this.tagId=null,this.tagList=[],this.showAssignEmployeeButton=!0,this.optOrgId=null,this.optOrgName=null,this.orgTreeLoading=!0,this.selectedOrgId=null,this.orgNodes=[],this.optJobId=null,this.optJobName=null,this.selectedJobId=null,this.jobsNodes=[],this.url="/org/service/organization/rpc/user/findByOrgId",this.employeeTableRequest={lazyLoad:!0,allInBody:!0,method:"POST",reName:{pi:"page",ps:"pageSize"},params:{orgId:"root",mode:"organization"}},this.employeeTableResponse={reName:{total:"data.totalElements",list:"data.content"}},this.columns=[{title:"\u59d3\u540d",index:"thirdPartyName",fixed:"left"},{title:"\u8d26\u53f7",index:"mobilePhone",fixed:"left"},{title:"\u6765\u6e90",index:"scene",format:d=>"wxcp"==d.scene?"\u4f01\u4e1a\u5fae\u4fe1":"miniapp"==d.scene?"\u5c0f\u7a0b\u5e8f":"ding"==d.scene?"\u9489\u9489":d.scene},{title:"",buttons:[]}]}globalSearch(){const t={searchValue:this.searchValue,mode:["organization","job","post","tag"]};""===this.searchValue||"undefined"===this.searchValue?this.showSearchResult=!1:(this.showSearchResult=!0,this.http.post("/org/service/organization/admin/employee/global-search",t).subscribe(n=>{n.success&&(this.panels=n.data)}))}searchResult(t){"employee"===t.type?(this.employeeTableTitle="\u3010\u4eba\u5458\u4fe1\u606f\u3011"+t.name,this.loadEmployeeTable("employee","",t.id,null,null,null,t.id)):"organization"===t.type?(this.employeeTableTitle="\u3010\u7ec4\u7ec7\u4eba\u5458\u4fe1\u606f\u3011"+t.name,this.loadEmployeeTable("organization","",t.id,null,null,null,null)):"post"===t.type?(this.employeeTableTitle="\u3010\u5c97\u4f4d\u4eba\u5458\u4fe1\u606f\u3011"+t.name,this.loadEmployeeTable("post","",null,t.id,null,null,null)):"job"===t.type?(this.employeeTableTitle="\u3010\u804c\u52a1\u4eba\u5458\u4fe1\u606f\u3011"+t.name,this.loadEmployeeTable("job","",null,null,t.id,null,null)):"tag"===t.type&&(this.employeeTableTitle="\u3010\u6807\u7b7e\u4eba\u5458\u4fe1\u606f\u3011"+t.name,this.loadEmployeeTable("tag","",null,null,null,t.id,null))}loadEmployeeTable(t,n,o,r,c,a,d){this.st.reload({mode:t,searchName:n,employeeId:o,orgId:o,postId:r,jobId:c,tagId:a})}activeTab(t){this.activeTabIndex=t,0===this.activeTabIndex?this.loadOrgTree():1===this.activeTabIndex?this.loadJobTree():2===this.activeTabIndex&&this.loadTagList()}orgEvent(t){const n=t.node;"expand"===t.eventName?n&&0===n.getChildren().length&&n.isExpanded&&this.http.get("/org/service/organization/admin/organization/tree/child/"+n.origin.key+"/"+n.origin.companyId).subscribe(o=>{o.success&&n.addChildren(o.data)}):"click"===t.eventName&&(this.activedOrgNode=n,this.selectedOrgId=n.key,this.loadEmployeeTable("organization","",this.selectedOrgId,null,null,null,null),this.employeeTableTitle="\u3010\u5458\u5de5\u4fe1\u606f\u3011"+n.title,this.activedOrgNode=n)}loadOrgTree(){this.orgTreeLoading=!0,this.http.get("/org/service/organization/admin/organization/tree/child/root").subscribe(t=>{t.success&&(this.orgNodes=t.data,this.orgTreeLoading=!1,this.employeeTableTitle="\u3010\u7ec4\u7ec7\u4eba\u5458\u4fe1\u606f\u3011"+this.orgNodes[0].title,this.selectedOrgId=this.orgNodes[0].key,this.loadEmployeeTable("index","",this.orgNodes[0].key,null,null,null,null))})}optOrg(t){this.optOrgId=t.key,this.optOrgName=t.title}orgOperation(t,n){console.log(t,n),"setup-post"===t?this.modal.createStatic(ze,{organization:{id:n.key,name:n.title}}).subscribe(()=>{}):"add"===t?this.modal.createStatic(pe,{organization:{id:n.key,name:n.title,mode:"add"}},{size:"md"}).subscribe(()=>{this.loadOrgTree()}):"edit-name"===t?this.modal.createStatic(pe,{organization:{id:n.key,name:n.title,mode:"edit"}},{size:"md"}).subscribe(()=>{this.loadOrgTree()}):"remove"===t&&(this.confirmModal=this.modalSrv.confirm({nzTitle:"\u5220\u9664\u786e\u8ba4?",nzContent:"\u662f\u5426\u786e\u8ba4\u5220\u9664\u90e8\u95e8 ["+n.title+"] ?",nzOnOk:()=>{this.http.post("/org/service/organization/admin/organization/remove",{id:n.key}).subscribe(r=>{r.success?(this.msgSrv.success("\u5220\u9664\u6210\u529f"),this.loadOrgTree()):this.msgSrv.error(r.message)})}}))}jobEvent(t){const n=t.node;"expand"===t.eventName?n&&0===n.getChildren().length&&n.isExpanded&&this.http.get("/org/service/organization/admin/job/tree/child/"+n.key).subscribe(o=>{o.success&&n.addChildren(o.data)}):"click"===t.eventName&&(this.selectedJobId=n.key,this.loadEmployeeTable("job",null,null,null,this.selectedJobId,null,null),this.activedJobNode=n,this.employeeTableTitle="\u3010\u804c\u52a1\u4eba\u5458\u4fe1\u606f\u3011"+n.title)}loadJobTree(){this.orgTreeLoading=!0,this.http.get("/org/service/organization/admin/job/tree").subscribe(t=>{t.success&&(this.jobsNodes=[...t.data],this.orgTreeLoading=!1),this.employeeTableTitle="\u3010\u804c\u52a1\u4eba\u5458\u4fe1\u606f\u3011"+this.jobsNodes[0].title,this.loadEmployeeTable("job",null,null,null,this.jobsNodes[0].key,null,null)})}optJob(t){this.optJobId=t.key,this.optJobName=t.title}jobOperation(t,n){console.log(n),"add"===t?this.modal.createStatic(K,{parentJob:{id:n.key,name:n.title}}).subscribe(()=>{this.loadJobTree()}):"edit"===t?this.modal.createStatic(K,{record:{id:n.key,name:n.title},parentJob:{id:n.key,name:n.title}}).subscribe(()=>{this.loadJobTree()}):"remove"===t&&this.http.post("/service/contact/admin/job/remove",{id:n.key}).subscribe(r=>{r.success?this.msgSrv.success(r.message):this.msgSrv.error(r.message),this.loadJobTree()})}addTag(){this.modal.createStatic(me,{i:{id:0}}).subscribe(()=>{this.loadTagList()})}editTag(t){this.modal.createStatic(me,{record:t}).subscribe(()=>{this.loadTagList()})}removeTag(t){this.confirmModal=this.modalSrv.confirm({nzTitle:"\u5220\u9664\u786e\u8ba4?",nzContent:"\u662f\u5426\u786e\u8ba4\u5220\u9664 ["+t.name+"] \u6807\u7b7e?",nzOnOk:()=>{this.http.post("/service/contact/admin/tag/remove",t).subscribe(n=>{n.success&&(this.msgSrv.success("\u5220\u9664\u6210\u529f"),this.loadTagList())})}})}loadTagList(){this.orgTreeLoading=!0,this.http.get("/service/contact/admin/tag/list").subscribe(t=>{t.success&&(this.tagList=[...t.data]),this.orgTreeLoading=!1,this.tagList.length>0&&(this.loadEmployeeTable("tag",null,null,null,null,this.tagList[0].id,null),this.employeeTableTitle="\u3010\u6807\u7b7e\u4eba\u5458\u4fe1\u606f\u3011"+this.tagList[0].name,this.tagId=this.tagList[0].id)})}activeTag(t){this.tagId=t.id,this.loadEmployeeTable("tag",null,null,null,null,this.tagId,null),this.employeeTableTitle="\u3010\u6807\u7b7e\u4eba\u5458\u4fe1\u606f\u3011"+t.name}addAccount(){this.modal.createStatic(G,{i:{id:0,orgId:this.selectedOrgId},mode:"add"}).subscribe(()=>this.st.reload())}selectUser(){}openFolder(t){}ngOnInit(){this.loadOrgTree()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.lP),e.Y36(Z.F0),e.Y36(u.Te),e.Y36(f.Sf),e.Y36(h.dD),e.Y36(z.Iw))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-contact"]],viewQuery:function(t,n){if(1&t&&e.Gf(An,5),2&t){let o;e.iGM(o=e.CRH())&&(n.st=o.first)}},decls:19,vars:14,consts:[["title","\u901a\u8baf\u5f55"],["id","CreateNewEmployeeButton"],["phActionTpl",""],["nz-row","","nzGutter","16"],["nz-col","","nzSpan","6",2,"max-width","400px"],["class","load-more",4,"ngIf"],[2,"width","100%",3,"nzSuffix"],["type","text","nz-input","","placeholder","\u641c\u7d22\u7ec4\u7ec7\u3001\u6210\u5458\u3001\u5c97\u4f4d\u3001\u804c\u52a1\u3001\u6807\u7b7e",3,"ngModel","ngModelChange","change"],["suffixIconSearch",""],[3,"nzSize","nzSelectedIndexChange",4,"ngIf"],[4,"ngIf"],["nz-col","","nzSpan","18"],[3,"nzTitle","nzExtra"],[3,"data","size","columns","req","res","scroll"],["st",""],["extraTemplate",""],["nz-button","","nzType","primary",3,"click"],[1,"load-more"],["nzSimple",""],["nz-icon","","nzType","search"],[3,"nzSize","nzSelectedIndexChange"],["nzTitle","\u7ec4\u7ec7"],["nzExpandAll","true",3,"nzData","nzAsyncData","nzTreeTemplate","nzExpandChange","nzClick","nzDblClick"],["nzTreeTemplate",""],[1,"custom-node"],["class","custom-node-item",4,"ngIf"],["orgOptMenu",""],["nz-menu",""],["nz-menu-item","","nzDisabled",""],["nz-menu-divider",""],["nz-menu-item","",3,"click"],["nz-icon","","nzType","plus-circle","nzTheme","outline"],["nz-icon","","nzType","edit","nzTheme","outline"],["nz-icon","","nzType","delete","nzTheme","outline"],["nz-icon","","nzType","deployment-unit","nzTheme","outline"],[1,"custom-node-item"],["nz-icon","",3,"nzType","click"],[1,"folder-name"],[1,"file-desc"],["nz-dropdown","","nzTrigger","click",3,"nzDropdownMenu"],["nz-icon","","nzType","file"],[1,"file-name"],["nz-icon","","nzType","menu","nzTheme","outline",3,"click"],[3,"nzBordered"],[3,"nzHeader","nzActive",4,"ngFor","ngForOf"],[3,"nzHeader","nzActive"],[3,"click",4,"ngFor","ngForOf"],[3,"click"],["nz-button","","nzType","default","nzBlock","",3,"click",4,"ngIf"],["nz-button","","nzType","default","nzBlock","",3,"click"],["nz-icon","","nzType","plus"]],template:function(t,n){if(1&t&&(e.TgZ(0,"page-header",0),e.YNc(1,wn,2,0,"ng-template",1,2,e.W1O),e.qZA(),e.TgZ(3,"div",3)(4,"div",4)(5,"nz-card"),e.YNc(6,Pn,2,0,"div",5),e.TgZ(7,"nz-input-group",6)(8,"input",7),e.NdJ("ngModelChange",function(r){return n.searchValue=r})("change",function(){return n.globalSearch()}),e.qZA()(),e.YNc(9,On,1,0,"ng-template",null,8,e.W1O),e.YNc(11,Jn,5,4,"nz-tabset",9),e.YNc(12,Bn,3,2,"div",10),e.qZA()(),e.TgZ(13,"div",11)(14,"nz-card",12),e._UZ(15,"st",13,14),e.qZA(),e.YNc(17,Yn,1,1,"ng-template",null,15,e.W1O),e.qZA()()),2&t){const o=e.MAs(10),r=e.MAs(18);e.xp6(6),e.Q6J("ngIf",n.orgTreeLoading),e.xp6(1),e.Q6J("nzSuffix",o),e.xp6(1),e.Q6J("ngModel",n.searchValue),e.xp6(3),e.Q6J("ngIf",!n.showSearchResult),e.xp6(1),e.Q6J("ngIf",n.showSearchResult),e.xp6(2),e.Q6J("nzTitle",n.employeeTableTitle)("nzExtra",r),e.xp6(1),e.Q6J("data",n.url)("size","small")("columns",n.columns)("req",n.employeeTableRequest)("res",n.employeeTableResponse)("scroll",e.DdM(13,Qn))}},directives:[B.q,g.ix,_.dQ,m.w,x.SK,x.t3,S.bd,p.O5,y.W,R.gB,R.ke,R.Zp,E.Fj,E.JJ,E.On,D.Ls,w.xH,w.xw,M.Hc,z.Ws,z.cm,z.RR,N.wO,N.r9,N.YV,L.yH,p.sg,L.Zv,k.A5],styles:["[_nghost-%COMP%]     .ant-tree{overflow:hidden;margin:0 -24px;padding:0 24px}[_nghost-%COMP%]     .ant-tree li{padding:4px 0 0}.custom-node[_ngcontent-%COMP%]{cursor:pointer;line-height:24px;margin-left:4px;display:inline-block}.custom-node[_ngcontent-%COMP%]:hover{background-color:#ccc}.custom-node[_ngcontent-%COMP%]:hover   .file-desc[_ngcontent-%COMP%], .custom-node[_ngcontent-%COMP%]:hover   .folder-desc[_ngcontent-%COMP%]{display:inline-block}.active[_ngcontent-%COMP%]{color:#1890ff;font-weight:700}.node-operation[_ngcontent-%COMP%]{color:#666;display:inline-block;padding:0 8px;display:block;line-height:24px;position:relative;left:12px}.file-name[_ngcontent-%COMP%], .folder-name[_ngcontent-%COMP%]{margin-left:4px}.file-desc[_ngcontent-%COMP%], .folder-desc[_ngcontent-%COMP%]{padding:0 8px;position:relative;left:4px;display:none}"]}),i})();const qn=["sf"];function jn(i,s){1&i&&e._UZ(0,"nz-spin",4)}function Hn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"sf",5,6)(2,"div",7)(3,"button",8),e.NdJ("click",function(){return e.CHM(t),e.oxw().close()}),e._uU(4,"\u5173\u95ed"),e.qZA(),e.TgZ(5,"button",9),e.NdJ("click",function(){e.CHM(t);const o=e.MAs(1);return e.oxw().save(o.value)}),e._uU(6," \u4fdd\u5b58 "),e.qZA()()()}if(2&i){const t=e.MAs(1),n=e.oxw();e.Q6J("schema",n.schema)("ui",n.ui)("formData",n.i),e.xp6(5),e.Q6J("disabled",!t.valid)("nzLoading",n.http.loading)}}let he=(()=>{class i{constructor(t,n,o,r){this.modal=t,this.modalRef=n,this.msgSrv=o,this.http=r,this.record={},this.attendanceGroupEmployeeData=[],this.schema={properties:{applicationId:{type:"string",title:"\u9700\u8981\u540c\u6b65\u4f01\u4e1a\u5e94\u7528id",ui:{widget:"select",asyncData:()=>this.http.get("//base/service/security/admin/application/list").pipe((0,te.U)(c=>[{label:"\u5e94\u7528\u5217\u8868",group:!0,children:c.data.map(C=>({label:C.name,value:C.id}))}]))}}},required:["owner","callNo","href","description"]},this.ui={"*":{spanLabelFixed:150,grid:{span:12}},$no:{widget:"text"},$href:{widget:"string"},$description:{widget:"textarea",grid:{span:24}}}}ngOnInit(){this.record.id>0&&this.http.get(`/user/${this.record.id}`).subscribe(t=>this.i=t)}save(t){this.http.get("//base/service/security/admin/userThirdPartyApi/synchronizeThirdPartyAccountWeb/"+t.applicationId,t).subscribe(n=>{this.msgSrv.success("\u540c\u6b65\u6210\u529f"),this.modalRef.close(!0)})}selectUser(){console.log(this.mode)}close(){this.modalRef.destroy()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.Te),e.Y36(f.Lf),e.Y36(h.dD),e.Y36(u.lP))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-synchronize"]],viewQuery:function(t,n){if(1&t&&e.Gf(qn,5),2&t){let o;e.iGM(o=e.CRH())&&(n.sf=o.first)}},decls:5,vars:2,consts:[[1,"modal-header"],[1,"modal-title"],["class","modal-spin",4,"ngIf"],["mode","edit","button","none",3,"schema","ui","formData",4,"ngIf"],[1,"modal-spin"],["mode","edit","button","none",3,"schema","ui","formData"],["sf",""],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"disabled","nzLoading","click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"\u540c\u6b65\u7b2c\u4e09\u65b9\u901a\u8baf\u5f55\u4fe1\u606f"),e.qZA()(),e.YNc(3,jn,1,0,"nz-spin",2),e.YNc(4,Hn,7,5,"sf",3)),2&t&&(e.xp6(3),e.Q6J("ngIf",!n.i),e.xp6(1),e.Q6J("ngIf",n.i))},directives:[p.O5,y.W,v.kJ,g.ix,_.dQ,m.w],encapsulation:2}),i})();const Vn=["sf"],$n=["st"];function Gn(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"button",5),e.NdJ("click",function(){return e.CHM(t),e.oxw().synchronizeThirdPartyAccount()}),e._uU(1,"\u540c\u6b65\u7b2c\u4e09\u65b9\u901a\u8baf\u5f55"),e.qZA()}}const Wn=function(){return{x:"1300px"}};let Ie=(()=>{class i{constructor(t,n){this.http=t,this.modal=n,this.url="/org/service/organization/admin/account/page-all",this.searchSchema={properties:{name:{type:"string",title:"\u7528\u6237\u540d\u79f0"}}},this.columns=[{title:"\u5e73\u53f0\u8d26\u53f7",index:"account"},{title:"\u7528\u6237\u540d\u79f0",index:"thirdPartyName"},{title:"\u624b\u673a\u53f7",index:"mobilePhone"},{title:"\u7528\u6237\u6240\u5c5e\u516c\u53f8",index:"companyName"},{title:"",buttons:[{text:"\u67e5\u770b",click:o=>`/form/${o.id}`},{text:"\u7f16\u8f91",type:"static",icon:"edit",click:o=>this.updatePageElementResource(o)}]}]}updatePageElementResource(t){this.modal.createStatic(G,{i:t},{size:"md"}).subscribe(()=>this.st.reload())}close(){}reset(){this.sf.reset(),this.sf.refreshSchema()}synchronizeThirdPartyAccount(){this.modal.createStatic(he,{i:{id:0},mode:"add"}).subscribe(()=>this.st.reload())}ngOnInit(){}add(){this.modal.createStatic(G,{i:{id:0},mode:"add"}).subscribe(()=>this.st.reload())}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.lP),e.Y36(u.Te))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-setup-account"]],viewQuery:function(t,n){if(1&t&&(e.Gf(Vn,5),e.Gf($n,5)),2&t){let o;e.iGM(o=e.CRH())&&(n.sf=o.first),e.iGM(o=e.CRH())&&(n.st=o.first)}},decls:7,vars:6,consts:[[3,"action"],["phActionTpl",""],["mode","search",3,"schema","formSubmit","formReset"],[3,"data","scroll","columns"],["st",""],["nz-button","","type","submit","nzType","primary",3,"click"]],template:function(t,n){if(1&t){const o=e.EpF();e.TgZ(0,"page-header",0),e.YNc(1,Gn,2,0,"ng-template",null,1,e.W1O),e.qZA(),e.TgZ(3,"nz-card")(4,"sf",2),e.NdJ("formSubmit",function(c){return e.CHM(o),e.MAs(6).reset(c)})("formReset",function(c){return e.CHM(o),e.MAs(6).reset(c)}),e.qZA(),e._UZ(5,"st",3,4),e.qZA()}if(2&t){const o=e.MAs(2);e.Q6J("action",o),e.xp6(4),e.Q6J("schema",n.searchSchema),e.xp6(1),e.Q6J("data",n.url)("scroll",e.DdM(5,Wn))("columns",n.columns)}},directives:[B.q,g.ix,_.dQ,m.w,S.bd,v.kJ,k.A5],encapsulation:2}),i})();var ci=l(149),ai=l(4420),P=l(7579);let Ze=(()=>{class i{constructor(){this.Change=new P.x}emit(t){this.Change.next(t)}subscribe(t){return this.Change.subscribe(t)}unSubscribe(){this.Change.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=e.Yz7({token:i,factory:i.\u0275fac,providedIn:"root"}),i})();function ui(i,s){1&i&&e._UZ(0,"i",12)}function di(i,s){1&i&&(e.TgZ(0,"div",13),e._UZ(1,"nz-spin",14),e.qZA())}function pi(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"nz-tree",15),e.NdJ("nzExpandChange",function(o){return e.CHM(t),e.oxw().orgEvent(o)})("nzClick",function(o){return e.CHM(t),e.oxw().orgEvent(o)})("nzDblClick",function(o){return e.CHM(t),e.oxw().orgEvent(o)}),e.qZA()}if(2&i){const t=e.oxw(),n=e.MAs(9);e.Q6J("nzData",t.orgNodes)("nzAsyncData","true")("nzTreeTemplate",n)}}function mi(i,s){1&i&&e._UZ(0,"i",22)}function hi(i,s){if(1&i&&(e.TgZ(0,"span",18),e._UZ(1,"i",19),e.TgZ(2,"span",20),e._uU(3),e.YNc(4,mi,1,0,"i",21),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("nzType",t.isExpanded?"folder-open":"folder"),e.xp6(2),e.hij(" ",t.title," "),e.xp6(1),e.Q6J("ngIf",t.origin.checked)}}function gi(i,s){1&i&&e._UZ(0,"i",26)}function _i(i,s){1&i&&e._UZ(0,"i",27)}function fi(i,s){1&i&&e._UZ(0,"i",22)}function Ci(i,s){if(1&i&&(e.TgZ(0,"span",18),e.YNc(1,gi,1,0,"i",23),e.YNc(2,_i,1,0,"i",24),e.TgZ(3,"span",25),e._uU(4),e.YNc(5,fi,1,0,"i",21),e.qZA()()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Q6J("ngIf","employee"==t.origin.category),e.xp6(1),e.Q6J("ngIf","employee"!=t.origin.category),e.xp6(2),e.hij(" ",t.title," "),e.xp6(1),e.Q6J("ngIf",t.origin.checked)}}function yi(i,s){if(1&i&&(e.TgZ(0,"span",16),e.YNc(1,hi,5,3,"span",17),e.YNc(2,Ci,6,4,"span",17),e.qZA()),2&i){const t=s.$implicit,n=e.oxw();e.ekj("active",(null==n.activeNode?null:n.activeNode.key)===t.key),e.xp6(1),e.Q6J("ngIf",!t.isLeaf),e.xp6(1),e.Q6J("ngIf",t.isLeaf)}}function vi(i,s){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.AsE("",t.projectName,"-",t.name,"")}}function xi(i,s){if(1&i&&(e.TgZ(0,"span"),e._uU(1),e.qZA()),2&i){const t=e.oxw().$implicit;e.xp6(1),e.Oqu(t.name)}}function Ti(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"p",32),e.NdJ("click",function(){const r=e.CHM(t).$implicit;return e.oxw(3).optSearchResult(r)}),e.YNc(1,vi,2,2,"span",8),e.YNc(2,xi,2,1,"span",8),e.qZA()}if(2&i){const t=s.$implicit;e.xp6(1),e.Q6J("ngIf","outsourceProject"!=t.category),e.xp6(1),e.Q6J("ngIf","outsourceProject"==t.category)}}function zi(i,s){if(1&i&&(e.TgZ(0,"nz-collapse-panel",30),e.YNc(1,Ti,3,2,"p",31),e.qZA()),2&i){const t=s.$implicit;e.Q6J("nzHeader",t.name)("nzActive",t.active),e.xp6(1),e.Q6J("ngForOf",t.childPanel)}}function bi(i,s){if(1&i&&(e.TgZ(0,"div")(1,"nz-collapse",28),e.YNc(2,zi,2,3,"nz-collapse-panel",29),e.qZA()()),2&i){const t=e.oxw();e.xp6(1),e.Q6J("nzBordered",!1),e.xp6(1),e.Q6J("ngForOf",t.panels)}}function Si(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",33),e.NdJ("click",function(){const o=e.CHM(t),r=o.$implicit,c=o.index;return e.oxw().commonDepartmentsClick(r,c)}),e.TgZ(1,"span"),e._uU(2),e.qZA()()}if(2&i){const t=s.$implicit;e.Tol(t.selected?"selectedItem":"item"),e.xp6(1),e.Tol(t.selected?"spanItem":""),e.xp6(1),e.Oqu(t.name)}}let ki=(()=>{class i extends class li{}{constructor(t,n,o,r,c){super(),this.http=t,this.modal=n,this.modalRef=o,this.msgSrv=r,this.rxjsChangeService=c,this.selectList=[],this.singleChoice=!1,this.selectListChange=new e.vpe,this.orgTreeLoading=!0,this.orgNodes=[],this.initList=[this.loadOrgTree,this.receiveDeleteId,this.getSelectedByCatch,this.renderSelectList],this.panels=[],this.showSearchResult=!1,this.selected=new Map,this.commonDepartments=[]}ngOnInit(){Promise.all(this.initList.map(t=>t.call(this))),Promise.resolve(this.commonDepartmentObtain()).then(t=>this.judgeCommonDepartmentSelect(t))}loadOrgTree(){this.orgTreeLoading=!0,this.http.get("/org/service/organization/admin/organization/tree/child/root").subscribe(t=>{t.success?this.orgNodes=t.data:this.msgSrv.warning(t.message),this.orgTreeLoading=!1})}inputChange(){this.timer&&clearTimeout(this.timer),this.timer=setTimeout(()=>{this.globalSearch(),clearTimeout(this.timer)},600)}globalSearch(){const t={searchValue:this.searchValue,mode:this.chooseMode};""===this.searchValue||"undefined"===this.searchValue?this.showSearchResult=!1:(this.orgTreeLoading=!0,this.showSearchResult=!0,this.http.post("/org/service/organization/admin/account/global-search",t).subscribe(n=>{n.success&&(this.panels=n.data),this.orgTreeLoading=!1}))}orgEvent(t){const n=t.node;switch(t.eventName){case"click":this.treeNodeClick(n);break;case"expand":this.treeExpand(n)}}treeExpand(t){0===t.getChildren().length&&t.isExpanded&&this.http.get("/org/service/organization/admin/organization/tree/child/"+t.origin.key+"/"+t.origin.companyId).subscribe(n=>{n.success&&t.addChildren(n.data)})}treeNodeClick(t){if(!(this.singleChoice&&this.selected.size>=1))switch(this.chooseMode){case"employee":this.addPerson(t);break;case"organization":this.addOrganization(t);break;case"department":this.addSelectedDepartmentList(t)}}optSearchResult(t){this.singleChoice&&this.selected.size>=1||this.addSelectedPersonList(t.type,t.loginUserId.toString(),t.name,"",t.projectId,t.projectName,t.companyId,t.companyName,t.thirdPartyAccountUserId)}addSelectedPersonList(t,n,o,r,c,a,d,C,T){this.selected.set(n,{name:o,id:n,corpId:r,projectId:c,projectName:a,category:t,companyId:d,companyName:C}),this.getSelectedList(this.selected)}getSelectedList(t){this.selectList=[],t.forEach(n=>this.selectList.push(n)),Promise.all([this.emitSelectFn(),this.cacheSelectList()])}receiveDeleteId(){this.unSub=this.rxjsChangeService.subscribe(t=>{this.selected.delete(t.id),this.getSelectedList(this.selected),this.judgeCommonDepartmentSelect(this.commonDepartments)})}addSelectedOrganizationList(t,n,o,r,c){this.selected.set(n,{name:o,id:n,category:t,companyId:r,companyName:c}),this.getSelectedList(this.selected)}addSelectedDepartmentList(t){"employee"===t.origin.category&&this.addPerson(t),"organization"===t.origin.category&&this.addSelectedOrganizationList(t.origin.category,t.key,t.title,t.origin.companyId,t.origin.companyName)}emitSelectFn(){this.selectListChange.emit(this.selectList)}cacheSelectList(){localStorage.setItem(this.functionName,JSON.stringify(this.selectList))}addPerson(t){(this.chooseMode===t.origin.category||"department"===this.chooseMode)&&this.addSelectedPersonList(t.origin.category,t.key,t.title,t.origin.corpId,t.parentNode.key,t.parentNode.title,t.origin.companyId,t.origin.companyName,t.origin.thirdPartyAccountUserId)}addOrganization(t){(this.chooseMode===t.origin.category||"department"===this.chooseMode)&&this.addSelectedOrganizationList(t.origin.category,t.key,t.title,t.origin.companyId,t.origin.companyName)}commonDepartmentObtain(){return new Promise(t=>{const n=localStorage.getItem("appId");this.http.post("/org/service/organization/SelectOrgTotalController/findByAppIdAndFunctionId",{pageNo:0,pageSize:this.pageSize,appId:n,functionId:this.functionName}).subscribe(r=>{this.commonDepartments=r.data.map(c=>({id:c.id,category:"organization",name:c.name,companyId:c.companyId,companyName:c.companyName,selected:!1})),t(this.commonDepartments)})})}renderSelectList(){this.selectList.length&&this.selectList.forEach(t=>this.selected.set(t.id,t))}judgeCommonDepartmentSelect(t){const n=this.selectList.map(o=>o.id);t.forEach(o=>o.selected=!!n.includes(o.id))}getSelectedByCatch(){(localStorage.getItem(this.functionName)?JSON.parse(localStorage.getItem(this.functionName)):[]).forEach(n=>this.selected.set(n.id,n))}commonDepartmentsClick(t,n){this.singleChoice&&this.selected.size>=1||(this.commonDepartments[n].selected=!0,this.addSelectedOrganizationList("organization",t.id,t.name,t.companyId,t.companyName))}ngOnDestroy(){this.unSub&&this.unSub.unsubscribe()}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.lP),e.Y36(u.Te),e.Y36(f.Lf),e.Y36(f.Sf),e.Y36(Ze))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-department"]],inputs:{chooseMode:"chooseMode",functionName:"functionName",pageSize:"pageSize",selectList:"selectList",singleChoice:"singleChoice"},outputs:{selectListChange:"selectListChange"},features:[e.qOj],decls:16,vars:6,consts:[[1,"container"],[1,"left"],[3,"nzSuffix"],["nz-input","","type","text","placeholder","input search text",3,"ngModel","ngModelChange","change"],["suffixIconSearch",""],["class","load-more",4,"ngIf"],[3,"nzData","nzAsyncData","nzTreeTemplate","nzExpandChange","nzClick","nzDblClick",4,"ngIf"],["nzTreeTemplate",""],[4,"ngIf"],[1,"right"],[1,"main"],[3,"class","click",4,"ngFor","ngForOf"],["nz-icon","","nzType","search"],[1,"load-more"],["nzSimple",""],[3,"nzData","nzAsyncData","nzTreeTemplate","nzExpandChange","nzClick","nzDblClick"],[1,"custom-node"],["class","custom-node-item",4,"ngIf"],[1,"custom-node-item"],["nz-icon","",3,"nzType"],[1,"folder-name",2,"margin-left","5px","margin-right","10px"],["nz-icon","","nzType","check","nzTheme","outline",4,"ngIf"],["nz-icon","","nzType","check","nzTheme","outline"],["nz-icon","","nzType","user",4,"ngIf"],["nz-icon","","nzType","file",4,"ngIf"],[1,"file-name",2,"margin-left","5px","margin-right","10px"],["nz-icon","","nzType","user"],["nz-icon","","nzType","file"],[3,"nzBordered"],[3,"nzHeader","nzActive",4,"ngFor","ngForOf"],[3,"nzHeader","nzActive"],["style","cursor: pointer;",3,"click",4,"ngFor","ngForOf"],[2,"cursor","pointer",3,"click"],[3,"click"]],template:function(t,n){if(1&t&&(e.TgZ(0,"div",0)(1,"div",1)(2,"nz-input-group",2)(3,"input",3),e.NdJ("ngModelChange",function(r){return n.searchValue=r})("change",function(){return n.inputChange()}),e.qZA()(),e.YNc(4,ui,1,0,"ng-template",null,4,e.W1O),e.YNc(6,di,2,0,"div",5),e.YNc(7,pi,1,3,"nz-tree",6),e.YNc(8,yi,3,4,"ng-template",null,7,e.W1O),e.YNc(10,bi,3,2,"div",8),e.qZA(),e.TgZ(11,"div",9)(12,"p"),e._uU(13,"\u5e38\u7528\u90e8\u95e8 : "),e.qZA(),e.TgZ(14,"div",10),e.YNc(15,Si,3,5,"div",11),e.qZA()()()),2&t){const o=e.MAs(5);e.xp6(2),e.Q6J("nzSuffix",o),e.xp6(1),e.Q6J("ngModel",n.searchValue),e.xp6(3),e.Q6J("ngIf",n.orgTreeLoading),e.xp6(1),e.Q6J("ngIf",!n.showSearchResult),e.xp6(3),e.Q6J("ngIf",n.showSearchResult),e.xp6(5),e.Q6J("ngForOf",n.commonDepartments)}},directives:[m.w,R.gB,R.ke,R.Zp,E.Fj,E.JJ,E.On,D.Ls,p.O5,y.W,M.Hc,L.yH,p.sg,L.Zv],styles:[".container[_ngcontent-%COMP%]{display:flex;box-sizing:border-box;height:auto}.container[_ngcontent-%COMP%]   .left[_ngcontent-%COMP%]{box-sizing:border-box;padding:10px;width:60%;border-right:1px solid #eeeeee;max-height:500px;overflow-x:hidden;overflow-y:auto}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]{box-sizing:border-box;width:40%;padding:10px}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%] > p[_ngcontent-%COMP%]:nth-of-type(1){margin-bottom:15px;color:#000}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .selectedItem[_ngcontent-%COMP%]{cursor:pointer;padding:2px 10px;margin-right:20px;margin-bottom:5px;background:#e3f5ff;border:1px solid #d7ebfd;box-sizing:border-box}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{cursor:pointer;padding:2px 10px;margin-right:20px;margin-bottom:5px;background:#f5f5f5;box-sizing:border-box}.container[_ngcontent-%COMP%]   .right[_ngcontent-%COMP%]   .main[_ngcontent-%COMP%]   .spanItem[_ngcontent-%COMP%]{color:#7799be}"]}),i})();function Ni(i,s){if(1&i){const t=e.EpF();e.TgZ(0,"div",10)(1,"span"),e._uU(2),e.qZA(),e.TgZ(3,"img",11),e.NdJ("click",function(){const o=e.CHM(t),r=o.index,c=o.$implicit;return e.oxw().del(r,c)}),e.qZA()()}if(2&i){const t=s.$implicit;e.xp6(2),e.Oqu(t.name)}}let Di=(()=>{class i{constructor(t,n,o,r){this.http=t,this.modal=n,this.msgSrv=o,this.rxjsChangeService=r,this.singleChoice=!1,this.selectList=[],this.pageSize=10}ngOnInit(){Promise.all([this.judge(),this.getSelectedByCatch()])}judge(){(!this.chooseMode||!this.functionName)&&(this.msgSrv.error("\u8bf7\u6b63\u786e\u4f20\u9012\u53c2\u6570"),this.close())}del(t,n){this.rxjsChangeService.emit({category:n.category,id:n.id}),this.selectList.splice(t,1)}clearCatch(){localStorage.removeItem(this.functionName)}getSelectedByCatch(){localStorage.getItem(this.functionName)&&(this.selectList=JSON.parse(localStorage.getItem(this.functionName)))}close(){this.modal.destroy()}save(){this.commonDepartments(),this.modal.close({selectList:this.selectList}),this.clearCatch()}commonDepartments(){const t=localStorage.getItem("appId"),n=this.selectList.filter(o=>"organization"===o.category).map(o=>({appId:t,functionId:this.functionName,orgId:o.id}));this.http.post("/org/service/organization/SelectOrgTotalController",n).subscribe(o=>{})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.lP),e.Y36(f.Lf),e.Y36(h.dD),e.Y36(Ze))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-select-project-person"]],decls:14,vars:6,consts:[[1,"modal-header"],[1,"modal-title"],[1,"choose"],[1,"selectMain"],["class","item",4,"ngFor","ngForOf"],["nzTitle","\u90e8\u95e8"],[3,"chooseMode","selectList","functionName","pageSize","singleChoice","selectListChange"],[1,"modal-footer"],["nz-button","","type","button",3,"click"],["nz-button","","type","submit","nzType","primary",3,"click"],[1,"item"],["src","./assets/tmp/img/del.png",3,"click"]],template:function(t,n){1&t&&(e.TgZ(0,"div",0)(1,"div",1),e._uU(2,"\u9009\u62e9\u4eba\u5458/\u90e8\u95e8"),e.qZA()(),e.TgZ(3,"nz-card",2)(4,"div",3),e.YNc(5,Ni,4,1,"div",4),e.qZA()(),e.TgZ(6,"nz-tabset")(7,"nz-tab",5)(8,"app-department",6),e.NdJ("selectListChange",function(r){return n.selectList=r}),e.qZA()()(),e.TgZ(9,"div",7)(10,"button",8),e.NdJ("click",function(){return n.close()}),e._uU(11,"\u5173\u95ed"),e.qZA(),e.TgZ(12,"button",9),e.NdJ("click",function(){return n.save()}),e._uU(13,"\u4fdd\u5b58"),e.qZA()()),2&t&&(e.xp6(5),e.Q6J("ngForOf",n.selectList),e.xp6(3),e.Q6J("chooseMode",n.chooseMode)("selectList",n.selectList)("functionName",n.functionName)("pageSize",n.pageSize)("singleChoice",n.singleChoice))},directives:[S.bd,p.sg,w.xH,w.xw,ki,g.ix,_.dQ,m.w],styles:[".choose[_ngcontent-%COMP%]{min-height:150px;overflow-x:hidden;overflow-y:auto}.choose[_ngcontent-%COMP%]   .selectMain[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap}.choose[_ngcontent-%COMP%]   .selectMain[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]{margin-right:10px;margin-bottom:5px;cursor:pointer;background:#f5f5f5;box-sizing:border-box;padding:2px 5px;display:inline-block}.choose[_ngcontent-%COMP%]   .selectMain[_ngcontent-%COMP%]   .item[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{color:#9b9b9a;margin-right:20px}"]}),i})();var Mi=l(2527);const Ei=["st"];function Ai(i,s){}const wi=[{path:"",redirectTo:"security/contact",pathMatch:"full"},{path:"check",component:re},{path:"app-permissions",component:Pe},{path:"user-permission",component:de},{path:"check-user-table",component:ue},{path:"data-permissions",component:le},{path:"security/resource-menu",component:be,data:{title:"\u83dc\u5355",titleI18n:"\u83dc\u5355"}},{path:"security/role-permission",component:Ae,data:{title:"\u89d2\u8272\u6743\u9650",titleI18n:"\u89d2\u8272\u6743\u9650"}},{path:"security/contact",component:Oe,data:{title:"\u7ec4\u7ec7\u673a\u6784",titleI18n:"\u7ec4\u7ec7\u673a\u6784"}},{path:"security/account",component:Ie,data:{title:"\u8d26\u53f7\u7ba1\u7406",titleI18n:"\u8d26\u53f7\u7ba1\u7406"}},{path:"synchronize",component:he,data:{title:"\u7b2c\u4e09\u65b9\u8d26\u6237\u540c\u6b65",titleI18n:"\u7b2c\u4e09\u65b9\u8d26\u6237\u540c\u6b65"}},{path:"user",component:(()=>{class i{constructor(t,n,o){this.modal=t,this.organizationService=n,this.msgSrv=o,this.url="/org/service/organization/admin/user/page-all",this.columns=[{title:"\u540d\u79f0",index:"name"},{title:"\u516c\u53f8Id",index:"corpId"},{title:"\u5e94\u7528",index:"category",type:"enum",enum:{wxCp:"\u4f01\u4e1a\u5fae\u4fe1",ding:"\u9489\u9489",yzj:"\u4e91\u4e4b\u5bb6",other:"\u5176\u4ed6"}},{title:"\u901a\u8baf\u5f55\u81ea\u52a8\u540c\u6b65",index:"automaticUpdate",type:"yn"},{title:"\u64cd\u4f5c",buttons:[{text:"\u7f16\u8f91",click:r=>{}},{text:"\u5220\u9664",icon:"delete",type:"del",pop:{title:"\u786e\u8ba4\u5220\u9664?",okType:"danger",icon:"star"},click:r=>{}}]}]}ngOnInit(){}choosePerson(){this.modal.createStatic(Di,{chooseMode:"employee",functionName:"not-clock",singleChoice:!0}).subscribe(t=>{console.log(t)})}}return i.\u0275fac=function(t){return new(t||i)(e.Y36(u.Te),e.Y36(Mi.M),e.Y36(h.dD))},i.\u0275cmp=e.Xpm({type:i,selectors:[["app-user-management"]],viewQuery:function(t,n){if(1&t&&e.Gf(Ei,5),2&t){let o;e.iGM(o=e.CRH())&&(n.stApp=o.first)}},decls:11,vars:3,consts:[[3,"action"],["phActionTpl",""],["nz-button","","nzType","primary"],[3,"data","columns"],["st",""],[3,"click"]],template:function(t,n){if(1&t&&(e.TgZ(0,"page-header",0),e.YNc(1,Ai,0,0,"ng-template",null,1,e.W1O),e.qZA(),e.TgZ(3,"nz-card")(4,"div")(5,"button",2),e._uU(6,"\u6dfb\u52a0\u4eba\u5458"),e.qZA()(),e._UZ(7,"st",3,4),e.qZA(),e.TgZ(9,"button",5),e.NdJ("click",function(){return n.choosePerson()}),e._uU(10,"\u9009\u4eba\u7ec4\u4ef6"),e.qZA()),2&t){const o=e.MAs(2);e.Q6J("action",o),e.xp6(7),e.Q6J("data",n.url)("columns",n.columns)}},directives:[B.q,S.bd,g.ix,_.dQ,m.w,k.A5],styles:[""]}),i})(),data:{title:"\u7528\u6237\u7ba1\u7406",titleI18n:"\u7528\u6237\u7ba1\u7406"}}];let Pi=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[Z.Bz.forChild(wi)],Z.Bz]}),i})();var ge=l(226),U=l(9697),Je=l(4832);l(4968),l(6406),l(3101);l(6451),l(3085),l(3601),l(9300),l(4090),l(1721),l(449),l(1135),l(5191),l(9646),l(3191),l(8076);let mo=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[ge.vT,p.ez,Je.g,U.Cl]]}),i})(),ho=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({imports:[[p.ez,Te.m8,w.we,mo,M.vO,D.PV,L.cD]]}),i})(),go=(()=>{class i{}return i.\u0275fac=function(t){return new(t||i)},i.\u0275mod=e.oAB({type:i}),i.\u0275inj=e.cJS({providers:[],imports:[[Te.m8,z.b1,D.PV,ci.F,ai.hP,se.Xo,M.vO,L.cD,Pi,ho]]}),i})()}}]);
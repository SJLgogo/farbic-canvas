<nz-card>
  <div class="head">
    <p class="title">应急事件历史报表</p>
    <nz-divider></nz-divider>
  </div>
  <div class="head-form">
    <div class="form-left">
      <sf #sf mode="search" [button]="null" [schema]="searchSchema"> </sf>
    </div>
    <div class="form-right">
      <button type="button" nz-button nzType="primary" (click)="exportExcel()">导出</button>
      <button type="default" nz-button (click)="resetSearch($event)">重置</button>
      <button type="button" nz-button nzType="primary" (click)="fromSearch()">查询</button>
    </div>
  </div>
</nz-card>

<nz-card>
  <st
    #st
    [widthMode]="{ type: 'strict' }"
    [data]="url"
    [req]="customRequests"
    [page]="customPage"
    [res]="customResponse"
    [columns]="columns"
    [scroll]="{ x: '2980px' }"
    [responsive]="false"
    [bordered]="true"
  >
  </st>
</nz-card>

<!-- 抽屉页面 -->
<nz-drawer [nzClosable]="true" [nzVisible]="visible" nzPlacement="right" (nzOnClose)="close()" nzWidth="880px">
  <!--  <p style="font-size: 22px; font-weight: 600">{{ basicInfo.emergencyTitle }}</p>
  <nz-divider></nz-divider> -->
  <div class="fixation">
    <div style="margin: 20px 0 0 20px">
      <p style="font-size: 22px; font-weight: 600">{{ basicInfo.emergencyTitle }}</p>
    </div>
    <nz-divider style="margin-bottom: 0"></nz-divider>
  </div>
  <div style="margin-top: 80px; position: relative">
    <div style="display: flex">
      <div class="content-item" style="margin-right: 34px">
        <div class="item-title">发生时间</div>
        <div class="item-content">{{ basicInfo.eventTime }}</div>
      </div>
      <div class="content-item">
        <div class="item-title">发生地点</div>
        <div class="item-content">
          <nz-tag *ngFor="let item of siteNameTag">{{ item }}</nz-tag>
        </div>
      </div>
    </div>
    <div class="content-item">
      <div class="item-title">发起人</div>
      <div class="item-content">{{ basicInfo.submitEmployeeName }}</div>
    </div>
    <div class="content-item" style="width: 400px">
      <div class="item-title">事件大类</div>
      <div class="item-content">{{ editEventCategoryData }}</div>
    </div>
    <div class="done-img">
      <img src="assets/img/signet.png" />
    </div>
  </div>
  <div class="divider"></div>
  <div class="content-item middle">
    <div class="item-title">应对专业</div>
    <div class="item-content">
      <nz-checkbox-group nzDisabled="checkbox" [(ngModel)]="editMajorData"></nz-checkbox-group>
    </div>
  </div>
  <div class="content-item middle">
    <div class="item-title">选择事件类型</div>
    <div class="item-content">
      <nz-checkbox-group nzDisabled="checkbox" [(ngModel)]="editEventData"></nz-checkbox-group>
    </div>
  </div>
  <div class="content-item middle">
    <div class="item-title">选择事件等级</div>
    <div class="item-content">
      <nz-tag *ngFor="let item of editLevelData">{{ item }}</nz-tag>
    </div>
  </div>
  <div class="item-title" style="width: 150px">事件概况及处理要求</div>
  <div class="event-detial">
    <p>{{ basicInfo.requirments }}</p>
  </div>
  <div class="item-title" style="margin-bottom: 18px">应急预案</div>
  <div>
    <div class="download" *ngFor="let item of submitEventVO.eventPlanVOS; let i = index" (click)="downloadFile(item)">
      <div>
        <img src="assets/img/icon-word.png" />
        <span>{{ item.title }}</span>
      </div>
      <img src="assets/img/icon-close.png" *ngIf="isChange" />
    </div>
  </div>
  <div>
    <div class="item-title" style="margin: 18px 0 18px 0">附件</div>
    <nz-divider style="margin: 0"></nz-divider>
    <div class="accessory" *ngFor="let item of submitEventVO.eventAttachmentFiles; let i = index" (click)="downloadAccessory(item)">
      <img src="assets/img/icon-excl.png" />
      <span>{{ item.fileName }}</span>
    </div>
  </div>
  <nz-divider style="margin: 0"></nz-divider>
  <div class="item-title" style="margin: 18px 0 0 0">应急发布</div>
  <div class="event-detial">
    <p>{{ emergencyReleaseVO.emergencyReleaseValue }}</p>
  </div>
  <nz-divider style="margin: 0"></nz-divider>
  <div style='padding: 15px 0'>
    <span class="item-title" style="margin-bottom: 18px">应急要点</span>
    <p class="check-btn" (click)="openCheck()">查看应急要点完成情况</p>
  </div>
  <nz-divider style="margin: 0"></nz-divider>
  <div class="item-title" style="margin-bottom: 20px; width: 150px">应急响应情况</div>
  <nz-divider style="margin: 0"></nz-divider>
  <!-- <div class="response">
    <chart-pie *ngFor="let item of responseData; let i = index" [color]="colorList[i]" [chartPieData]="item.chartPieData">
      <p>{{ item.title }}</p>
    </chart-pie>
  </div> -->
  <!-- 饼状图 -->
  <div class="response">
<!--    <chart-pie-->
<!--      style="margin-right: 30px"-->
<!--      *ngFor="let item of responseData; let i = index"-->
<!--      class="response-chart"-->
<!--      [chartPieData]="item.chartPieData"-->
<!--      [color]="colorList[i]"-->
<!--      [ngClass]="{-->
<!--        'choose-chart': i == listIndex,-->
<!--        bg1: listIndex == 0 && i == 0,-->
<!--        bg2: listIndex == 1 && i == 1,-->
<!--        bg3: listIndex == 2 && i == 2,-->
<!--        bg4: listIndex == 3 && i == 3-->
<!--      }"-->
<!--      (click)="clickChart(i)"-->
<!--    >-->
<!--      <p>{{ item.title }}</p>-->
<!--    </chart-pie>-->
  </div>
  <!-- 消息阅读情况详情 -->
  <div *ngIf="listIndex == 1">
    <p class="message-title">消息阅读情况</p>
    <nz-divider style="margin: 0"></nz-divider>
    <div *ngIf="!this.showResponseDetail">
      <p style="color: #000000; margin-top: 10px">未读人员({{ notReadData.number }})</p>
      <div class="message" id="notRead">
        <!--  消息列表-->
        <div id="notReadList">
          <div class="message-list" *ngFor="let item of responseList.notRead">
            <img [src]="item.avatar" *ngIf="item.avatar" />
            <nz-avatar [nzSize]="40" [nzIcon]="'user'" *ngIf="!item.avatar" style="margin-right: 16px"></nz-avatar>
            <div class="list-detail">
              <p>{{ item.name }}</p>
              <p>{{ item.deptName }}</p>
            </div>
          </div>
          <div class="loadMore" *ngIf="notReadData.isLoading" (click)="openModalTable(notReadData.modalTableParams, 1)">点击查看更多</div>
        </div>
      </div>
      <p style="color: #000000; margin-top: 10px">已读人员({{ readData.number }})</p>
      <div class="message" id="read">
        <!-- 消息列表 -->
        <div id="readList">
          <div class="message-list" *ngFor="let item of responseList.read">
            <img [src]="item.avatar" *ngIf="item.avatar" />
            <nz-avatar [nzSize]="40" [nzIcon]="'user'" *ngIf="!item.avatar" style="margin-right: 16px"></nz-avatar>
            <div class="list-detail">
              <p>{{ item.name }}</p>
              <p>{{ item.deptName }}</p>
            </div>
          </div>
          <div class="loadMore" *ngIf="readData.isLoading" (click)="openModalTable(readData.modalTableParams, 1)">点击查看更多</div>
        </div>
      </div>
    </div>
  </div>

  <!-- 电话通知情况详情 -->
  <div *ngIf="listIndex == 0">
    <p class="message-title">电话通知情况</p>
    <nz-divider style="margin: 0"></nz-divider>
    <div *ngIf="!this.showResponseDetail">
      <div class="message-phone">
        <span>未接通人员({{ notCallData.number }})</span>
        <div class="phone-reset" (click)="recall()" *ngIf="false">
          <img src="assets/img/icon-phone-call.png" />
          <span style="color: #00b168">重新拨打</span>
        </div>
      </div>
      <!-- 未接通消息列表 -->
      <div class="message" id="notCall">
        <!--  消息列表-->
        <div id="notCallList">
          <div class="message-list" *ngFor="let item of responseList.notCall">
            <img [src]="item.avatar" *ngIf="item.avatar" />
            <nz-avatar [nzSize]="40" [nzIcon]="'user'" *ngIf="!item.avatar" style="margin-right: 16px"></nz-avatar>
            <div class="list-detail">
              <p>{{ item.name }}</p>
              <p>{{ item.deptName }}</p>
            </div>
            <div class="list-detail-right">
              <p>{{ item.phoneTurnOnTime }}</p>
            </div>
          </div>
          <div class="loadMore" *ngIf="notCallData.isLoading" (click)="openModalTable(notCallData.modalTableParams, 1)">点击查看更多</div>
        </div>
      </div>
      <p style="color: #000000; margin-top: 10px">已接通人员({{ callData.number }})</p>
      <!-- 已接通列表 -->
      <div class="message" id="call">
        <!-- 消息列表 -->
        <div id="callList">
          <div class="message-list" *ngFor="let item of responseList.call">
            <img [src]="item.avatar" *ngIf="item.avatar" />
            <nz-avatar [nzSize]="40" [nzIcon]="'user'" *ngIf="!item.avatar" style="margin-right: 16px"></nz-avatar>
            <div class="list-detail">
              <p>{{ item.name }}</p>
              <p>{{ item.deptName }}</p>
            </div>
            <div class="list-detail-right" style="flex-direction: column">
              <p style="color: #d8a10d">{{ item.callTime }}秒</p>
              <p>{{ item.phoneTurnOnTime }}</p>
            </div>
          </div>
          <div class="loadMore" *ngIf="callData.isLoading" (click)="openModalTable(callData.modalTableParams, 1)">点击查看更多</div>
        </div>
      </div>
    </div>
  </div>

  <!-- 人员签到情况 -->
  <div *ngIf="listIndex == 2">
    <p class="message-title">人员签到情况</p>
    <nz-divider style="margin: 0"></nz-divider>
    <div *ngIf="!this.showResponseDetail">
      <div style="color: #000000; margin: 10px 0 14px">
        <span>未打卡人员({{ notSignData.number }})</span>
      </div>
      <div class="message" id="notSign">
        <!--  消息列表-->
        <div id="notSignList">
          <div class="message-list" *ngFor="let item of responseList.notSign">
            <img [src]="item.avatar" *ngIf="item.avatar" />
            <nz-avatar [nzSize]="40" [nzIcon]="'user'" *ngIf="!item.avatar" style="margin-right: 16px"></nz-avatar>
            <div class="list-detail">
              <p>{{ item.name }}</p>
              <p>{{ item.deptName }}</p>
            </div>
          </div>
          <div class="loadMore" *ngIf="notSignData.isLoading" (click)="openModalTable(notSignData.modalTableParams, 1)">点击查看更多</div>
        </div>
      </div>
      <p style="color: #000000; margin-top: 10px">已打卡人员({{ signData.number }})</p>
      <div class="message" id="sign">
        <!-- 消息列表 -->
        <div id="signList">
          <div class="message-list" *ngFor="let item of responseList.sign">
            <img [src]="item.avatar" *ngIf="item.avatar" />
            <nz-avatar [nzSize]="40" [nzIcon]="'user'" *ngIf="!item.avatar" style="margin-right: 16px"></nz-avatar>
            <div class="list-detail">
              <div>
                <span>{{ item.name }}</span>
                <span class="clock-manual clock" *ngIf="item.manualSignIn">手动打卡</span>
                <span class="clock-auto clock" *ngIf="!item.manualSignIn">自动打卡</span>
                <span class="arrive clock" *ngIf="item.arrivedScene">已到达</span>
                <span class="action clock" *ngIf="!item.arrivedScene">应急行动中</span>
              </div>
              <p>{{ item.deptName }}</p>
            </div>
            <div class="list-detail-right" style="flex-direction: column">
              <p style="color: #d8a10d">{{ item.latestSignInSite }}</p>
              <p>{{ item.signTime }}</p>
            </div>
            <!--  <div class="imglist" *ngIf="item.imgList.length !== 0">
          <img *ngFor="let img of item.imgList" [src]="img" />
        </div> -->
          </div>
          <div class="loadMore" *ngIf="signData.isLoading" (click)="openModalTable(signData.modalTableParams, 1)">点击查看更多</div>
        </div>
      </div>
    </div>
  </div>

  <!-- 物资运输情况 -->
  <div *ngIf="listIndex == 3">
    <p class="message-title">物资运输情况</p>
    <div>
      <div class="message-phone nav">
        <span [ngClass]="{ 'nav-choose': navchoose == 0 }" (click)="navChoose(0)">物资筹备({{tagNum.preparation}})</span>
        <span [ngClass]="{ 'nav-choose': navchoose == 1 }" (click)="navChoose(1)">物资运输中({{tagNum.transport}})</span>
        <span [ngClass]="{ 'nav-choose': navchoose == 2 }" (click)="navChoose(2)">物资使用中({{tagNum.user}})</span>
      </div>
      <!-- 物资运输中列表 -->
      <div class="message" *ngIf="navchoose == 0" style="height: 750px">
        <!--  消息列表-->
        <div class="message-list" *ngFor="let item of goodsTransportList">
          <img src="{{item.sourceEmployeeAvatar}}" />
          <div class="list-detail">
            <p>{{item.sourceEmployeeName}}</p>
            <!--            <p>车辆设备分部</p>-->
          </div>
          <!--          <div class="goods-list-right">-->
          <!--            <img src="assets/img/icon-site.png" />-->
          <!--            <span style="vertical-align: text-top">当前站点：前梅</span>-->
          <!--          </div>-->
          <div class="goods-list-bot">
            <span style="padding-right: 20px; border-right: 1px solid #666666">运送物资：{{item.goodsName}}</span>
            <span style="padding: 0 20px; border-right: 1px solid #666666">运送数量：{{item.goodsNumber}}</span>
            <span style="padding-left: 20px">运送终点：{{item.stationName}}</span>
          </div>
        </div>
      </div>
      <!-- 物资筹备中列表 -->
      <div class="message" *ngIf="navchoose == 1" style="height: 750px">
        <!--  消息列表-->
        <div class="message-list" *ngFor="let item of goodsTransportList">
          <img src="assets/img/icon-add-people.png" />
          <div class="list-detail">
            <p>{{item.transportEmployeeName}}</p>
            <!--            <p>车辆设备分部</p>-->
          </div>
          <div class="goods-list-right" *ngIf="item.latestSignInSite">
            <img src="assets/img/icon-site.png"/>
            <span style="vertical-align: text-top">当前站点：{{item.latestSignInSite}}</span>
          </div>
          <div class="goods-list-bot">
            <span style="padding-right: 20px; border-right: 1px solid #666666">运送物资：{{item.goodsName}}</span>
            <span style="padding: 0 20px; border-right: 1px solid #666666">运送数量：{{item.goodsNumber}}</span>
            <span style="padding-left: 20px">运送终点：{{item.stationName}}</span>
          </div>
        </div>
      </div>
      <!-- 物资使用中列表 -->
      <div class="message" *ngIf="navchoose == 2" style="height: 750px">
        <!--  消息列表-->
        <div class="message-list" *ngFor="let item of goodsTransportList">
          <img src="assets/img/icon-add-people.png" />
          <div class="list-detail">
            <p>{{item.recipientEmployeeName}}</p>
            <!--            <p>车辆设备分部</p>-->
          </div>
          <div class="goods-list-right">
            <div style="margin-bottom: 15px">
              <img src="assets/img/icon-site.png" />
              <span style="vertical-align: text-top">当前站点：{{item.stationName}}</span>
            </div>

            <!--            <click-button (click)="showModal(item)">-->
            <!--              <span btntext>物资反馈情况</span>-->
            <!--            </click-button>-->
          </div>
          <div class="goods-list-bot">
            <span style="padding-right: 20px; border-right: 1px solid #666666">运送物资：{{item.goodsName}}</span>
            <span style="padding: 0 20px; border-right: 1px solid #666666">运送数量：{{item.goodsNumber}}</span>
            <span style="padding-left: 20px">运送终点：{{item.stationName}}</span>
          </div>
        </div>
      </div>
    </div>
  </div>
  <nz-divider style="margin: 0"></nz-divider>
<!--  <personnel-info [personnelInfoData]="personnelInfoData"></personnel-info>-->
<!--  <category-choose (categoryStatus)="categoryStatus($event)"></category-choose>-->
  <!-- 最新处置措施 -->
  <div class="measure" *ngIf="!showClassify">
<!--    <measure-item *ngFor="let item of itemDetail" [itemDetail]="item"></measure-item>-->
  </div>
  <!-- 应急全貌 -->
  <div class="emergency-all" *ngIf="showClassify">
<!--    <emergency-item-->
<!--      *ngFor="let item of emergencyItemList; let i = index"-->
<!--      [itemDetail]="item"-->
<!--      (click)="openEmengencyItem(i)"-->
<!--    ></emergency-item>-->
  </div>
  <div style="height: 60px"></div>
  <div class="footer">
    <div class="footer-left">
      <button nz-button="" (click)="openEventChangeHistory()">
        <span btntext>事件变更历史</span>
      </button>
    </div>
    <button type="button" (click)="close()" class="ant-btn ant-btn-primary"><span>确定</span></button>
  </div>

  <nz-drawer [nzClosable]="true" [nzWidth]="drawerWidth" [nzVisible]="childrenVisible" (nzOnClose)="closeChildren()">
    <!-- 事件变更日志页面 -->
    <div *ngIf="pageChoose == 1">
      <p class="blod-title">事件变更日志</p>
      <nz-divider style="margin: 10px 0"></nz-divider>
      <p class="blod-title">{{ basicInfo.emergencyTitle }}</p>
      <!-- <div class="content-item">
        <div class="item-title">分类</div>
        <nz-select nzAllowClear nzPlaceHolder="请选择">
          <nz-option *ngFor="let option of optionList" [nzValue]="option" [nzLabel]="option.label"> </nz-option>
        </nz-select>
      </div> -->
      <div class="division" style="width: 540px"></div>
      <!-- 日志列表 -->
      <div class="log-list" *ngFor="let item of eventChangeLog">
        <div class="blod-title2">
          <span style="margin-right: 10px">{{ item.createdTime }}</span
          ><span>{{ item.operationEmployeeName }}</span>
        </div>
        <div>
          <div style="display: inline-block; vertical-align: top">类型：</div>
          <div style="display: inline-block; width: 75%">{{ item.operationDetail }}</div>
        </div>
        <div>
          <div style="display: inline-block; vertical-align: top">变更前：</div>
          <div style="display: inline-block; width: 75%">{{ item.elementHistoryName }}</div>
        </div>
        <div>
          <div style="display: inline-block; vertical-align: top">变更后：</div>
          <div style="display: inline-block; width: 75%">{{ item.elementNowName }}</div>
        </div>
      </div>
    </div>

    <!-- 应急全貌详情页面 -->
    <div *ngIf="pageChoose == 2">
      <p class="blod-title">应急全貌</p>
      <nz-divider style="margin: 10px 0"></nz-divider>
      <p style="font-size: 16px; font-weight: 700; margin: 0">应急响应情况</p>
      <div class="response">
<!--        <chart-pie-->
<!--          style="margin-right: 30px"-->
<!--          *ngFor="let item of responseData2; let i = index"-->
<!--          class="response-chart"-->
<!--          [chartPieData]="item.chartPieData"-->
<!--          [color]="colorList2[i]"-->
<!--          [ngClass]="{-->
<!--            'choose-chart': i == emergencyListIndex,-->
<!--            bg1: emergencyListIndex == 0 && i == 0,-->
<!--            bg2: emergencyListIndex == 1 && i == 1,-->
<!--            bg3: emergencyListIndex == 2 && i == 2,-->
<!--            bg4: emergencyListIndex == 3 && i == 3-->
<!--          }"-->
<!--          (click)="emergencyClickChart(i)"-->
<!--        >-->
<!--          <p>{{ item.title }}</p>-->
<!--        </chart-pie>-->
      </div>
      <!-- 消息阅读情况详情 -->
      <div *ngIf="emergencyListIndex == 1">
        <p class="message-title">消息阅读情况</p>
        <nz-divider style="margin: 0"></nz-divider>
        <div *ngIf="!this.showResponseDetail">
          <p style="color: #000000; margin-top: 10px">未读人员({{ childNotReadData.number }})</p>
          <div class="message" id="childNotRead">
            <!--  消息列表-->
            <div id="childNotReadList">
              <div class="message-list" *ngFor="let item of emergencyResponseList.notRead">
                <img [src]="item.avatar" *ngIf="item.avatar" />
                <nz-avatar [nzSize]="40" [nzIcon]="'user'" *ngIf="!item.avatar" style="margin-right: 16px"></nz-avatar>
                <div class="list-detail">
                  <p>{{ item.name }}</p>
                  <p>{{ item.deptName }}</p>
                </div>
              </div>
              <div class="loadMore" *ngIf="childNotReadData.isLoading" (click)="openModalTable(childNotReadData.modalTableParams, 0)">
                点击查看更多
              </div>
            </div>
          </div>
          <p style="color: #000000; margin-top: 10px">已读人员({{ childReadData.number }})</p>
          <div class="message" id="childRead">
            <!-- 消息列表 -->
            <div id="childReadList">
              <div class="message-list" *ngFor="let item of emergencyResponseList.read">
                <img [src]="item.avatar" *ngIf="item.avatar" />
                <nz-avatar [nzSize]="40" [nzIcon]="'user'" *ngIf="!item.avatar" style="margin-right: 16px"></nz-avatar>
                <div class="list-detail">
                  <p>{{ item.name }}</p>
                  <p>{{ item.deptName }}</p>
                </div>
              </div>
              <div class="loadMore" *ngIf="childReadData.isLoading" (click)="openModalTable(childReadData.modalTableParams, 0)">
                点击查看更多
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 电话通知情况详情 -->
      <div *ngIf="emergencyListIndex == 0">
        <p class="message-title">电话通知情况</p>
        <nz-divider style="margin: 0"></nz-divider>
        <div *ngIf="!this.showResponseDetail">
          <div class="message-phone">
            <span>未接通人员({{ childNotCallData.number }})</span>
            <div class="phone-reset" (click)="recall()" *ngIf="isShowReNotice && responseList.notCall.length">
              <img src="assets/img/icon-phone-call.png" />
              <span style="color: #00b168">重新拨打</span>
            </div>
          </div>
          <!-- 未接通消息列表 -->
          <div class="message" id="childNotCall">
            <!--  消息列表-->
            <div id="childNotCallList">
              <div class="message-list" *ngFor="let item of emergencyResponseList.notCall">
                <img [src]="item.avatar" *ngIf="item.avatar" />
                <nz-avatar [nzSize]="40" [nzIcon]="'user'" *ngIf="!item.avatar" style="margin-right: 16px"></nz-avatar>
                <div class="list-detail">
                  <p>{{ item.name }}</p>
                  <p>{{ item.deptName }}</p>
                </div>
                <div class="list-detail-right">
                  <p>{{ item.phoneTurnOnTime }}</p>
                </div>
              </div>
              <div class="loadMore" *ngIf="childNotCallData.isLoading" (click)="openModalTable(childNotCallData.modalTableParams, 0)">
                点击查看更多
              </div>
            </div>
          </div>
          <p style="color: #000000; margin-top: 10px">已接通人员({{ childCallData.number }})</p>
          <!-- 已接通列表 -->
          <div class="message" id="childCall">
            <!-- 消息列表 -->
            <div id="childCallList">
              <div class="message-list" *ngFor="let item of emergencyResponseList.call">
                <img [src]="item.avatar" *ngIf="item.avatar" />
                <nz-avatar [nzSize]="40" [nzIcon]="'user'" *ngIf="!item.avatar" style="margin-right: 16px"></nz-avatar>
                <div class="list-detail">
                  <p>{{ item.name }}</p>
                  <p>{{ item.deptName }}</p>
                </div>
                <div class="list-detail-right" style="flex-direction: column">
                  <p style="color: #d8a10d">{{ item.callTime }}秒</p>
                  <p>{{ item.phoneTurnOnTime }}</p>
                </div>
              </div>
              <div class="loadMore" *ngIf="childCallData.isLoading" (click)="openModalTable(childCallData.modalTableParams, 0)">
                点击查看更多
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 人员签到情况 -->
      <div *ngIf="emergencyListIndex == 2">
        <p class="message-title">人员签到情况</p>
        <nz-divider style="margin: 0"></nz-divider>
        <div *ngIf="!this.showResponseDetail">
          <div style="color: #000000; margin: 10px 0 14px">
            <span>未打卡人员({{ childNotSignData.number }})</span>
          </div>
          <div class="message" id="childNotSign">
            <!--  消息列表-->
            <div id="childNotSignList">
              <div class="message-list" *ngFor="let item of emergencyResponseList.notSign">
                <img [src]="item.avatar" *ngIf="item.avatar" />
                <nz-avatar [nzSize]="40" [nzIcon]="'user'" *ngIf="!item.avatar" style="margin-right: 16px"></nz-avatar>
                <div class="list-detail">
                  <p>{{ item.name }}</p>
                  <p>{{ item.deptName }}</p>
                </div>
              </div>
              <div class="loadMore" *ngIf="childNotSignData.isLoading" (click)="openModalTable(childNotSignData.modalTableParams, 0)">
                点击查看更多
              </div>
            </div>
          </div>
          <p style="color: #000000; margin-top: 10px">已打卡人员({{ childSignData.number }})</p>
          <div class="message" id="childSign">
            <!-- 消息列表 -->
            <div id="childSignList">
              <div class="message-list" *ngFor="let item of emergencyResponseList.sign">
                <img [src]="item.avatar" *ngIf="item.avatar" />
                <nz-avatar [nzSize]="40" [nzIcon]="'user'" *ngIf="!item.avatar" style="margin-right: 16px"></nz-avatar>
                <div class="list-detail">
                  <div>
                    <span>{{ item.name }}</span>
                    <span class="clock-manual clock" *ngIf="item.manualSignIn">手动打卡</span>
                    <span class="clock-auto clock" *ngIf="!item.manualSignIn">自动打卡</span>
                    <span class="arrive clock" *ngIf="item.arrivedScene">已到达</span>
                    <span class="action clock" *ngIf="!item.arrivedScene">应急行动中</span>
                  </div>
                  <p>{{ item.deptName }}</p>
                </div>
                <div class="list-detail-right" style="flex-direction: column">
                  <p style="color: #d8a10d">{{ item.latestSignInSite }}</p>
                  <p>{{ item.signTime }}</p>
                </div>
                <!--  <div class="imglist" *ngIf="item.imgList.length !== 0">
              <img *ngFor="let img of item.imgList" [src]="img" />
            </div> -->
              </div>
              <div class="loadMore" *ngIf="childSignData.isLoading" (click)="openModalTable(childSignData.modalTableParams, 0)">
                点击查看更多
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- 物资运输情况 -->
      <div *ngIf="emergencyListIndex == 3">
        <p class="message-title">物资运输情况</p>
        <div *ngIf="false">
          <div class="message-phone nav">
            <span [ngClass]="{ 'nav-choose': navchoose == 0 }" >物资运输中(12)</span>
            <span [ngClass]="{ 'nav-choose': navchoose == 1 }" >物资筹备(23)</span>
            <span [ngClass]="{ 'nav-choose': navchoose == 2 }" >物资使用中(21)</span>
          </div>
          <!-- 物资运输中列表 -->
          <div class="message" *ngIf="navchoose == 0" style="height: 750px">
            <!--  消息列表-->
            <div class="message-list" *ngFor="let item of [0, 1, 2, 3, 4, 5, 6, 7]">
              <img src="assets/img/peng.jpg" />
              <div class="list-detail">
                <p>彭于晏</p>
                <p>车辆设备分部</p>
              </div>
              <div class="goods-list-right">
                <img src="assets/img/icon-site.png" />
                <span style="vertical-align: text-top">当前站点：前梅</span>
              </div>
              <div class="goods-list-bot">
                <span style="padding-right: 20px; border-right: 1px solid #666666">运送物资：防火面罩</span>
                <span style="padding: 0 20px; border-right: 1px solid #666666">运送数量：20</span>
                <span style="padding-left: 20px">运送终点：北京</span>
              </div>
            </div>
          </div>
          <!-- 物资筹备中列表 -->
          <div class="message" *ngIf="navchoose == 1" style="height: 750px">
            <!--  消息列表-->
            <div class="message-list" *ngFor="let item of [0, 1, 2, 3, 4, 5, 6, 7]">
              <img src="assets/img/peng.jpg" />
              <div class="list-detail">
                <p>彭于晏</p>
                <p>车辆设备分部</p>
              </div>
              <div class="goods-list-bot">
                <span style="padding-right: 20px; border-right: 1px solid #666666">运送物资：防火面罩</span>
                <span style="padding: 0 20px; border-right: 1px solid #666666">运送数量：20</span>
                <span style="padding-left: 20px">运送终点：衙前</span>
              </div>
            </div>
          </div>
          <!-- 物资使用中列表 -->
          <div class="message" *ngIf="navchoose == 2" style="height: 750px">
            <!--  消息列表-->
            <div class="message-list" *ngFor="let item of [0, 1, 2, 3, 4, 5, 6, 7]">
              <img src="assets/img/peng.jpg" />
              <div class="list-detail">
                <p>彭于晏</p>
                <p>车辆设备分部</p>
              </div>
              <div class="goods-list-right">
                <div style="margin-bottom: 15px">
                  <img src="assets/img/icon-site.png" />
                  <span style="vertical-align: text-top">当前站点：前梅</span>
                </div>

                <button nz-button="">
                  <span btntext>物资反馈情况</span>
                </button>
              </div>
              <div class="goods-list-bot">
                <span style="padding-right: 20px; border-right: 1px solid #666666">运送物资：防火面罩</span>
                <span style="padding: 0 20px; border-right: 1px solid #666666">运送数量：20</span>
                <span style="padding-left: 20px">运送终点：衙前</span>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 应急要点审核 -->
    <div *ngIf="pageChoose == 3">
      <p class="blod-title">应急要点审核</p>
      <nz-divider style="margin: 10px 0"></nz-divider>
      <!-- 应急处置要点选择 -->
      <div class="content-item">
        <div class="item-title" style="width: 160px">应急处置要案要点选择</div>
        <nz-select [(ngModel)]="selectPoint" (ngModelChange)="choosePoint($event)" nzAllowClear nzPlaceHolder="请选择" style="width: 200px">
          <nz-option *ngFor="let option of pointList" [nzValue]="option" [nzLabel]="option.label"> </nz-option>
        </nz-select>
      </div>
      <div class="content-item" style="display: flex">
        <div class="item-title" style="width: 162px">总进度</div>
        <div style="width: 300px">
          <nz-progress [nzPercent]="pointRate"></nz-progress>
        </div>
      </div>
      <!-- 应急角色选择 -->
      <div class="content-item">
        <div class="item-title" style="width: 160px">应急角色选择</div>
        <nz-select [(ngModel)]="selectRole" (ngModelChange)="chooseRole($event)" nzAllowClear nzPlaceHolder="请选择" style="width: 200px">
          <nz-option *ngFor="let option of roleList" [nzValue]="option" [nzLabel]="option.label"> </nz-option>
        </nz-select>
      </div>
      <div class="content-item" style="display: flex">
        <div class="item-title" style="width: 162px">当前角色处理进度</div>
        <div style="width: 300px">
          <nz-progress [nzPercent]="roleRate"></nz-progress>
        </div>
      </div>
      <!-- 全部要点 -->
      <div style="background-color: #f2f2f4">
        <div class="point-detail" *ngFor="let item of allEmergencyPointData; let i = index">
          <div *ngIf="allEmergencyPointData.length != 0">
            <div class="point-detail-title">
              <span class="point-name">处置要点{{ i + 1 }}</span>
            </div>
            <div class="point-detail-content">
              <div style="margin-bottom: 40px">{{ item.content }}</div>
              <p style="margin-top: 22px">应急物资参考</p>
              <div style="margin-bottom: 30px">{{ item.materialReference }}</div>
            </div>
            <div class="feedback" (click)="item.hidden = !item.hidden">
              <span style="vertical-align: middle; margin-right: 15px">反馈人数：{{ item.reportNumber }}人</span>
              <img src="assets/img/icon-up-black.png" *ngIf="!item.hidden" />
              <img src="assets/img/icon-down-black.png" *ngIf="item.hidden" />
            </div>
            <!-- 反馈内容详情 -->
            <div *ngIf="!item.hidden">
              <div class="point-detail-content" *ngFor="let list of item.reportItem">
                <div class="point-detail-title">
                  <span style="font-weight: 700">{{ list.deptName }}</span>
                </div>
                <div style="margin-top: 15px" *ngFor="let pointList of list.reportEmployeeList">
                  <div class="feedback-content">{{ pointList.content }}</div>
                  <div class="content-img">
                    <img nz-image width="200px" [nzSrc]="img" *ngFor="let img of pointList.resources" />
                  </div>
                  <div class="point-detail-title" style="margin: 20px 0 10px">
                    <span>反馈人员：{{ pointList.name }}</span>
                    <span>{{ pointList.time }}</span>
                  </div>
                  <nz-divider></nz-divider>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <!-- 应急发布记录页面 -->
    <!--    <div *ngIf="pageChoose == 2">-->
    <!--      <p class="blod-title">应急发布记录</p>-->
    <!--      <nz-divider style="margin: 10px 0"></nz-divider>-->
    <!--      <div class="log-list" *ngFor="let item of emergengcyReleaseLog">-->
    <!--        <p class="blod-title2">{{ item.time }}</p>-->
    <!--        <p>{{ item.content }}</p>-->
    <!--      </div>-->
    <!--    </div>-->
  </nz-drawer>
</nz-drawer>
<nz-modal [(nzVisible)]="isShowDownload" nzTitle="" (nzOnCancel)="downloadCancel()">
  <div *nzModalContent>
    <p style="font-size: 18px; margin: 0">是否下载该文件？</p>
  </div>
  <div *nzModalFooter>
    <button nz-button nzType="default" (click)="downloadCancel()">取消</button>
    <button
      nz-button
      down-file
      nzType="primary"
      [http-url]="fileDownloadUrl"
      [file-name]="fileName"
      class="mr-sm"
      (success)="downloadOk($event)"
      (error)="downloadFail($event)"
    >
      下载
    </button>
  </div>
</nz-modal>
